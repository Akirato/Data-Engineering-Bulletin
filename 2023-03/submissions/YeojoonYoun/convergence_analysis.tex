\section{Convergence Analysis}
\label{convergence_analysis}

The rigorous theoretical guarantees of reducing communication complexity under strongly-convex and homogeneous assumptions should come first to ensure the significance of FedAQ as one of the standards of communication-efficient federated optimization algorithms. Proving convergence guarantees of FedAQ even under these assumptions requires careful consideration of the approximation error induced by the quantization scheme combined with the convergence analysis of acceleration based methods.
To recall, in FedAQ the server aggregates two quantized local updates $Q(w_{k, \tau}^m - w_k), Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})$ from all clients (See line 11 in Algorithm \ref{algorithm1}) in each round. If we simply try to generalize the convergence guarantee of FedAC to incorporate the quantization variance costs, the proof techniques from earlier quantization-based methods cannot be directly applied, as we now have two additional quantization error terms that contribute to the overall cost. A significant amount of additional effort is required in order to account for this new quantization error. %The key challenge in bounding the error terms induced by $Q(w_{k, \tau}^m - w_k), Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})$ is to show that both the local model parameters $w_{k, t}^m$, $w_{k, t}^{\textrm{ag}, m}$ converge to $w^*$ as number of communication rounds and local updates increase.

In this section, we first define two condition sets of hyperparameters used for the convergence analysis of FedAQ. Then, we provide the proof sketch of FedAQ under one such condition set that leads to the better convergence rate $\Tilde{\mathcal{O}}(\frac{1+q}{MT}+\frac{1+q}{TK^3})$. The full proofs of lemmas, theorems, and corollaries under both condition sets are elaborated in \cref{app:proofs} and \cref{app:proofs2}. Finally, we discuss how we obtain the new convergence rate for \cite{haddadpour2021federated} and look into more theoretical details on contribution \ref{contribution2} in Introduction.  %The full proofs of lemmas, theorems, and corollaries are elaborated in Appx.~\ref{app:proofs} and Appx.~\ref{app:proofs2}. %Let us first dive into the proof sketch of FedAQ under the condition set (\ref{parameter_FedAQ}).

\subsection{Two Parameter Condition Sets}

We carefully determine two parameter condition sets that theoretically ensure the convergence guarantees. The first one is
\begin{align} \label{parameter_FedAQ}
    \eta, \gamma \in \Big( 0, \frac{1}{L} \Big], \gamma = \max \Big( \sqrt{\frac{\eta}{\mu\tau}}, \eta \Big), \alpha = \frac{1}{\gamma\mu}, \beta = \alpha + 1
\end{align}
We add one more condition $\gamma \in (0, \frac{1}{L}]$ to the FedAC-I condition \cite{yuan2020federated} and create our parameter condition set (\ref{parameter_FedAQ}). The second one is
\begin{align} \label{parameter2_FedAQ}
    \eta, \gamma \in \Big( 0, \frac{1}{L} \Big], \gamma = \max \Big( \sqrt{\frac{\eta}{\mu\tau}}, \eta \Big), \alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta = \frac{2\alpha^2-1}{\alpha-1}, \gamma\mu \leq \frac{3}{4}
\end{align}
We add two more conditions $\gamma \in (0, \frac{1}{L}]$ and $\gamma\mu \leq \frac{3}{4}$ to the FedAC-II condition to build our parameter condition set (\ref{parameter2_FedAQ}). Even though quantization adds complexity to the algorithm, these weak assumptions are the only additional requirements for showing the convergence of FedAQ. Moreover, although the better convergence rate $\Tilde{\mathcal{O}}(\frac{1+q}{MT}+\frac{1+q}{TK^3})$ is obtained from the condition set (\ref{parameter2_FedAQ}), we also analyze the convergence of FedAQ under the condition set (\ref{parameter_FedAQ}) because this set empirically leads to more stable training and better performance in experiments than the condition set (\ref{parameter2_FedAQ}) (See Strongly convex case in \cref{qualitative_analysis}). The intuition of the less stable training of FedAQ under the condition set (\ref{parameter2_FedAQ}) comes from larger $\alpha, \beta$ than those of the condition set (\ref{parameter_FedAQ}). If $\alpha, \beta$ are too large, $\alpha^{-1}, \beta^{-1}$ in Algorithm \ref{algorithm1} cannot be used as proper coupling coefficients for local parameters $w_{k, t}^m, w_{k, t}^{\textrm{ag}, m}, w_{k, t}^{\textrm{md}, m}$. This results in aggressive updates and less stable training behavior.

\subsection{Proof Sketch of FedAQ Under Condition Set (\ref{parameter2_FedAQ})}

The decentralized potential $\Phi_{k, t}$ \cite{yuan2020federated} is used for our convergence analysis. People commonly use this potential for acceleration analysis \cite{bansal2019potential}.
\begin{gather*}
    \Phi_{k, t} = F(\Bar{w}_{k, t}^{\textrm{ag}}) -F^* + \frac{1}{6} \mu \|\Bar{w}_{k, t} - w^*\|^2
\end{gather*}
$\Bar{w}_{k, t}$ and $\Bar{w}_{k, t}^{\textrm{ag}}$ is respectively the average of $w_{k, t}^m$ and $w_{k, t}^{\textrm{ag, m}}$ for all $m$. Here, we additionally define $\Phi_k$ as below.
\begin{gather*}
    \Phi_k := \Phi_{k, 0} = F(w_k^{\textrm{ag}}) - F^* + \frac{1}{6} \mu \|w_k - w^*\|^2
\end{gather*}
Since $w_k$ and $w_k^{\textrm{ag}}$ are parameters obtained after $k$th synchronization in a server side, $\Phi_k$ can be considered as the potential of server models. $\Phi_k$ is essential to show the convergence of FedAQ because there is the computation of the quantizer between $\Phi_{k-1, \tau}$ and $\Phi_{k, 0}$. Thus, we should not naively track $\Phi_{k, t}$ but track $\Phi_k$ for our analysis. Obtaining $\Phi_k \leq \epsilon$ would imply that $F(w_k^{\textrm{ag}}) - F^* \leq \epsilon$ and since $F^* \leq F(w_k^{\textrm{ag}})$, it would also imply that $\|w_k - w^*\|^2 = O(\epsilon)$, thus obtaining convergence in terms of both the objective value and the iterate.

Our goal is to show the convergence of FedAQ and derive the simplified convergence rate so that we can get the number of communication rounds to achieve a linear speedup in $M$. As the first step to show this, we prove Lemma \ref{lemmaD.1} which represents the relationship between two consecutive server potential functions $\Phi_k$ and $\Phi_{k+1}$. The quantization scheme amplifies the instability to the convergence of FedAQ in addition to the effect of acceleration. Despite this challenge, we derive Lemma \ref{lemmaD.1} with the help of subtle Propositions (See \cref{app:proof_lemma2}).

% \begin{lemma} \label{lemma3.1}
%  Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \tau \geq 2, $ FedAQ yields
%  \begin{align*}
%      \mathbb{E}[&\Psi_{k+1}] \leq C(\gamma, \tau) \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2 \\
%      &+ \gamma\mu L \tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\| \|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|] \\
%      &+ \underbrace{\frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2}_{\textrm{Additional terms due to quantization}}
%  \end{align*}
%  Where $C(\gamma, \tau)$ is defined as
%  \begin{align*}
%      C(\gamma, \tau) = (1-\gamma\mu)^\tau + \underbrace{\frac{q}{M}\Big( \frac{4\gamma^2\mu(\mu + L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2}_{\textrm{Additional terms due to quantization}}
%  \end{align*}
% \end{lemma}

\begin{lemma} \label{lemmaD.1}
 Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \gamma\mu \leq \frac{3}{4},\tau \geq 2, $ FedAQ yields
 \begin{align*}
     \mathbb{E}[\Phi_{k+1}] &\leq D(\gamma, \tau) \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}})- \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
     &+ \underbrace{\frac{q}{M}(\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big( (\gamma-\eta)^2 \gamma^2\mu^2 (\frac{\mu}{3} + \frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L \Big)\tau^3\sigma^2}_{\textrm{additional terms due to quantization}}
 \end{align*}
 Where $D(\gamma, \tau)$ is defined as
 \begin{align*}
     D(\gamma, \tau) &= (1-\frac{1}{3}\gamma\mu)^\tau + \underbrace{\frac{q}{M}\Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2 L(\frac{\mu}{3} + L)\Big)\tau^2}_{\textrm{additional terms due to quantization}}
 \end{align*}
\end{lemma}

We get the inequality between $\Phi_k$ and $\Phi_{k+1}$ by finding the upper bounds of error terms due to multiple($\tau$) local steps and the quantization step. The upper bound of the error caused by multiple local steps is obtained with the help of the analysis in \cite{yuan2020federated} (See Proposition \ref{propositionD.3}). Also, we get the tight upper bound of the error due to quantization with our new proof techniques (See Proposition \ref{propositionD.4}, \ref{propositionD.5}, \ref{propositionD.6}). The key challenge in bounding the quantization error terms comes from representing the upper bound of variances of the quantizer $Q$ on two local updates $w_{k, \tau}^m - w_k, w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}$ in the form of a server potential $\Phi_k$. Some terms in Lemma \ref{lemmaD.1} are similar to those in Lemma C.2 of the FedAC paper \cite{yuan2020federated}, but our lemma contains additional terms that emerge from the quantization scheme.

For the next step, by telescoping Lemma \ref{lemmaD.1}, we obtain the main theoretical result Theorem \ref{theorem2}. Theorem \ref{theorem2} represents how $\Phi_K$ decreases from the initial potential $\Phi_0$ as a communication round $K$ increases. Since we aim to telescope Lemma \ref{lemmaD.1}, $D(\gamma, \tau)$ should be smaller than 1. Specifically, we show $D(\gamma, \tau) \leq 1-\frac{1}{6}\gamma\mu\tau$ with condition (\ref{condition2}) (See \cref{app:proof_theorem2}). That's why Theorem \ref{theorem2} requires the learning rate $\gamma$ to satisfy the certain condition (\ref{condition2}).

% \begin{theorem} \label{theorem1}
%     Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}}), \eta, \gamma \in (0, \frac{1}{L}], \tau \geq 2, $ if the learning rate $\gamma$ satisfies
%     \begin{align} \label{condition1}
%         \Big(\mu^2 + \frac{q}{M}(\mu+L)(4\mu+2L)\Big)\gamma\tau \leq \frac{1}{2}\mu
%     \end{align}
%     FedAQ yields
%     \begin{align*}
%         &\mathbb{E}[\Psi_K] \leq \exp{\Big(-\frac{1}{2}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Psi_0 + (2q+1)(\frac{\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{\eta\sigma^2}{M}) + 14\eta^2 L\tau\sigma^2 \\
%         &+ \frac{(780+\frac{2q}{M})\eta^{\frac{3}{2}}L\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}} + \frac{(\mu+L)(\mu^2+\mu L+L^2)q\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{q\eta^3\tau^2(\mu+L)^2 L\sigma^2}{\mu M}
%     \end{align*}
% \end{theorem}

\begin{theorem} \label{theorem2}
    Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for the parameter condition set (\ref{parameter2_FedAQ}), $\tau \geq 2, $ if the learning rate $\gamma$ satisfies
    \begin{align} \label{condition2}
        \bigg( \frac{1}{9}\mu^2 +\frac{q}{M}\Big( \mu(\frac{8}{3}\mu +2L) + 2L(\frac{\mu}{3}+L)\Big)\bigg)\gamma\tau \leq \frac{1}{6}\mu
    \end{align}
    FedAQ yields
    \begin{align*}
        \mathbb{E}[\Phi_K] &\leq \exp{\Big(-\frac{1}{6}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Phi_0 + \frac{2(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{8(q+25)\eta^2 L^2\tau\sigma^2}{\mu} \\
        &+ \frac{3q\Big(\mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2\Big)\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{3qL(\frac{\mu}{3}+L)^2 \eta^3\tau^2\sigma^2}{\mu M}
    \end{align*}
\end{theorem}

We get the convergence rate of FedAQ with respect to $\eta$ under the condition set (\ref{parameter2_FedAQ}). The final step is to tune $\eta$ appropriately and obtain a more intuitive form of convergence rate that we can easily analyze a linear speedup in $M$. The exact form of this can be found in Corollary \ref{corollary2}. Here, we introduce the simplified form of Corollary \ref{corollary2}.

% \begin{corollary} \label{corollary1}
%     Let $C_1, C_2,\textrm{ and } \eta_0$ as below. Note that $T = K\tau$.
%     \begin{align*}
%         C_1 &= \frac{(\mu+L)(\mu^2+\mu L+L^2)q}{\mu^{\frac{5}{2}}}, \textrm{ } C_2 = \frac{q(\mu+L)^2 L}{\mu} \\
%         \eta_0 &= \frac{4\tau}{\mu T^2}\log^2\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big)
%     \end{align*}
%     Then for $\eta = \min(\frac{1}{L}, \eta_0)$, FedAQ yields
%     \begin{align}
%         &\mathbb{E}[\Psi_K] \leq \min \Big( \exp(-\tfrac{\mu T}{2L}), \exp(-\tfrac{\mu^{\tfrac{1}{2}}T}{2 L^{\tfrac{1}{2}}\tau^{\tfrac{1}{2}}})\Big) \Psi_0 \nonumber \\
%         &+ \tfrac{7(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\tfrac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) \\
%         &+ \tfrac{(6465+\tfrac{16q}{M})L\tau^2\sigma^2}{\mu^2 T^3}\log^4 \Big(e+ \tfrac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) \\
%         &+ \tfrac{9(\mu^{\tfrac{3}{2}}C_1+8C_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \tfrac{\mu^3 M T^3\Psi_0}{(\mu^{\tfrac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big)
%     \end{align}
% \end{corollary}
% \begin{corollary} \label{corollary2}
%     Let $D_1, D_2,\textrm{ and } \eta_0$ as below. Note that $T = K\tau$.
%     \begin{align*}
%         D_1 &= \frac{\Big( \mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2) \Big)q}{\mu^{\frac{5}{2}}}, \textrm{ } D_2 = \frac{q(\frac{\mu}{3}+L)^2 L}{\mu} \\
%         \eta_0 &= \frac{36\tau}{\mu T^2}\log^2\Big(e+\min(\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}, \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}, \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}) \Big)
%     \end{align*}
%     Then for $\eta = \min(\frac{1}{L}, \eta_0)$, FedAQ yields
%     \begin{align}
%         \mathbb{E}[\Phi_K] &\leq \min \Big( \exp(-\frac{\mu T}{6L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{6 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Phi_0 \nonumber\\
%         &+ \frac{13(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}\Big) \\
%         &+ \frac{10369(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4}\log^4 \Big(e+ \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}\Big) \\
%         &+ \frac{649(\mu^{\frac{3}{2}}D_1+216D_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+216 D_2)\tau^2\sigma^2}\Big)
%     \end{align}
% \end{corollary}
\begin{corollary}
    (Simplified form of Corollary \ref{corollary2}) Note that $T = K\tau$. For $\eta = \min(\frac{1}{L}, \tilde{\Theta} (  \frac{\tau}{\mu T^2} ))$, FedAQ yields
    \begin{align*}
        \mathbb{E}[\Phi_K] &\leq \min \Big( \exp(-\frac{\mu T}{6L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{6 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Phi_0 + \Tilde{\mathcal{O}}( \underbrace{\frac{(1+q)\sigma^2}{\mu MT}}_{\textrm{I}} + \underbrace{\frac{(1+q)L^2\tau^3\sigma^2}{\mu^3 T^4}}_{\textrm{II}} + \underbrace{\frac{qL^3 \tau^2 \sigma^2}{\mu^4 M T^3}}_{\textrm{III}})
    \end{align*}
\end{corollary}

The convergence rate of FedAQ under the condition set (\ref{parameter_FedAQ}) is obtained in a similar way. The convergence analysis under the condition set (\ref{parameter_FedAQ}) is elaborated as Lemma \ref{lemma3.1}, Theorem \ref{theorem1}, and Corollary \ref{corollary1} in \cref{app:proofs}.

\begin{remark} \label{remark5.4} The above convergence rate is worse than the convergence rate of FedAC-II according to Theorem C.13 in \cite{yuan2020federated} because there are additive terms related to the quantization noise $q$ in our case. Let's figure out the dominant terms with $\Tilde{\mathcal{O}}$ notation from the above convergence rate. Here, we replace $\tau$ with $\frac{T}{K}$. At first, we can ignore the first term because it decreases exponentially. The second term I would be $\Tilde{\mathcal{O}}(\frac{1+q}{MT})$. Then, the third term II becomes $\Tilde{\mathcal{O}}(\frac{(1+q)\tau^3}{T^4}) = \Tilde{\mathcal{O}}(\frac{1+q}{TK^3})$. Finally, the last term III turns into $\Tilde{\mathcal{O}}(\frac{q\tau^2}{MT^3}) = \Tilde{\mathcal{O}}(\frac{q}{MTK^2})$. Thus, the overall convergence rate of FedAQ under the condition set (\ref{parameter2_FedAQ}) would be $\Tilde{\mathcal{O}}(\frac{1+q}{MT} + \frac{1+q}{TK^3})$. Similarly, we obtain the simplified convergence rate of FedAQ under the condition set (\ref{parameter_FedAQ}) from three terms (14), (15), (16) of Corollary \ref{corollary1}. In this case, the convergence rate of FedAQ is $\Tilde{\mathcal{O}}(\frac{1+q}{MT} + \frac{1}{TK^2})$, and the required number of communication rounds to achieve a linear speedup in $M$ is $\Tilde{\mathcal{O}}((\frac{M}{1+q})^{\frac{1}{2}})$. \end{remark}

\begin{remark} \label{remark5.5} As we mention above, FedAQ converges at rate $\Tilde{\mathcal{O}}(\frac{1+q}{MT} + \frac{1+q}{TK^3})$, which is better than the convergence rate of \cite{haddadpour2021federated} $\Tilde{\mathcal{O}}(\frac{1+q}{MT}+\frac{1}{TK})$. To our knowledge, \cite{haddadpour2021federated} obtain the best convergence rate among previous quantization-based federated optimization algorithms. Actually, in the strongly-convex and homogeneous case, \cite{haddadpour2021federated} provide different convergence rate $\mathcal{O}(\frac{1}{\gamma^2\tau} + \frac{(q+1)}{(\frac{q}{M}+1)\tau M}) = \mathcal{O}(\frac{K}{\gamma^2 T} + \frac{(q+1)K}{(\frac{q}{M}+1)T M})$, where $\gamma$ is a learning rate for the server updates. They achieve this convergence rate by tuning $\eta = \frac{1}{2L(\frac{q}{M} + 1)\tau \gamma}$. However, we cannot say this algorithm achieves a linear speedup in this scenario. That's why we provide a new convergence rate $\Tilde{\mathcal{O}}(\frac{1+q}{MT}+\frac{1}{TK})$ for \cite{haddadpour2021federated} by tuning $\eta$ in a different way. This new $\eta$ makes this algorithm achieve a linear speedup. Why the original $\eta$ cannot achieve a linear speedup and how we get new $\eta$ can be found in \cref{app:fedcomgate}.
\end{remark}

\subsection{Proof Details for FedAQ under Condition Set (\ref{parameter_FedAQ})}
\label{app:proofs}

Before diving into proof details, we define $\Bar{w}_{k, \tau}, \Bar{w}_{k, \tau}^{\textrm{ag}}, \Psi_{k, t}^m, \Psi_{k, t}, \Psi_k, A_{k, t}^m$ as below.
\begin{align*}
    \Bar{w}_{k, \tau} &= \frac{1}{M} \sum_{m=1}^M w_{k, \tau}^m \\
    \Bar{w}_{k, \tau}^{\textrm{ag}} &= \frac{1}{M} \sum_{m=1}^M w_{k, \tau}^{\textrm{ag}, m} \\
    \Psi_{k, t}^m &= F(w_{k, t}^{\textrm{ag}, m}) - F^* + \frac{1}{2} \mu \|w_{k, t}^m - w^*\|^2\\
    \Psi_{k, t} &= \frac{1}{M} \sum_{m=1}^M F(w_{k, t}^{\textrm{ag}, m}) -F^* + \frac{1}{2} \mu \|\Bar{w}_{k, t} - w^*\|^2 \\
    \Psi_k :&= \Psi_{k, 0} = F(w_k^{\textrm{ag}}) - F^* + \frac{1}{2} \mu \|w_k - w^*\|^2\\
    A_{k, t}^m &= \frac{\gamma^2\mu^2 (\mu+L)}{(1+\gamma\mu)^2}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + \gamma^2(\mu + L)\frac{2L}{1+\gamma\mu}\Psi_{k, t}^m
    %\chi_{k, t}^m &= \frac{\mu}{2}\|w_{k, t}^m - w_k\|^2 + \frac{L}{2} \|w_{k, t}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2
\end{align*}
The above notations are essential to our convergence analysis. Intuitively, if the FedAQ algorithm converges to the optimal point, $\Bar{w}_{k, \tau}, \Bar{w}_{k, \tau}^{\textrm{ag}}$ become $w^*$, and $\Psi_{k, t}^m, \Psi_{k, t}, \Psi_k, A_{k, t}^m$ become 0. In order to denote the $\sigma$-algebra generated by $\{w_{k^\prime, t^\prime}^m, w_{k^\prime, t^\prime}^{\textrm{ag}, m}\}_{(k^\prime < k) \textrm{ or } (k^\prime = k, t^\prime \leq t), m \in [M]}$, we use $\mathcal{F}_{k, t}$.

\subsubsection{Proof of Lemma \ref{lemma3.1}}
\label{app:proof_lemma}

\begin{lemma} \label{lemma3.1}
 Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \tau \geq 2, $ FedAQ yields
 \begin{align*}
     \mathbb{E}[&\Psi_{k+1}] \leq C(\gamma, \tau) \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2 \\
     &+ \gamma\mu L \tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\| \|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|] \\
     &+ \underbrace{\frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2}_{\textrm{Additional terms due to quantization}}
 \end{align*}
 Where $C(\gamma, \tau)$ is defined as
 \begin{align*}
     C(\gamma, \tau) = (1-\gamma\mu)^\tau + \underbrace{\frac{q}{M}\Big( \frac{4\gamma^2\mu(\mu + L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2}_{\textrm{Additional terms due to quantization}}
 \end{align*}
\end{lemma}


In this section, we first introduce five crucial Propositions for proving Lemma \ref{lemma3.1}. Then, we prove Lemma \ref{lemma3.1} by using Propositions in the last part of this section.
\begin{proposition} \label{proposition3.2}
Let Assumption \ref{assumption1} hold and consider any $k$ synchronization round. Then, we can decompose the expectation as follows:
\begin{align*}
    \mathbb{E}[\|w_{k+1} - w^*\|^2] &= \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] + \mathbb{E}[\|\Bar{w}_{k, \tau} - w^*\|^2] \\
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F^*] &= \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - \frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m})] + \mathbb{E}[\frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m}) - F^*]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{proposition3.2}} \textrm{ } The second equality is trivial. Let's focus on the first equality. By Assumption \ref{assumption1}, the quantizer $Q$ is unbiased and we get,
\begin{align*}
    \mathbb{E}_Q[w_{k+1}] &= w_k + \frac{1}{M}\sum_{m=1}^M \mathbb{E}_Q Q(w_{k, \tau}^m - w_k) = \frac{1}{M} \sum_{m=1}^M w_{k, \tau}^m = \Bar{w}_{k, \tau}
\end{align*}
Thus, we finally obtain
\begin{align*}
    \mathbb{E}[\|w_{k+1} - w^*\|^2] &= \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau} + \Bar{w}_{k, \tau} - w^*\|^2] \\
    &= \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] + \mathbb{E}[\|\Bar{w}_{k, \tau} - w^*\|^2]
\end{align*}

\begin{proposition} \label{proposition3.3}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta \in (0, \frac{1}{L}]$, FedAQ yields
\begin{align*}
    \mathbb{E}[\Psi_{k, \tau}] &\leq (1-\gamma\mu)^\tau \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\tau\sigma^2 + \gamma\mu L \tau \\
    &\cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{proposition3.3}} \textrm{ } We refer to the proof of Lemma B.2 in \cite{yuan2020federated}. There is no quantization between $\Psi_{k, \tau}$ and $\Psi_k$. Thus, we can directly apply useful inequalities in the proof of Lemma B.2 in \cite{yuan2020federated} to our proof. Then, we obtain
\begin{align*}
    \mathbb{E}[\Psi_{k, t+1}|\mathcal{F}_{k, t}] &\leq (1-\gamma\mu) \Psi_{k, t} + \frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\sigma^2 + \gamma\mu L \\
    &\cdot \frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|
\end{align*}
From the above relationship between $\Psi_{k, t+1}$ and $\Psi_{k, t}$, we get
\begin{align*}
    \mathbb{E}[\Psi_{k, \tau}] &\leq (1-\gamma\mu)^\tau \mathbb{E}[\Psi_k] + \Big(\sum_{t=0}^{\tau-1} (1-\gamma\mu)^t \Big)\frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\sigma^2 + \gamma\mu L \cdot \sum_{t=0}^{\tau-1} \Big\{ (1-\gamma\mu)^{\tau-t-1} \\
    &\mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]\Big\} \\
    &\leq (1-\gamma\mu)^\tau \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\tau\sigma^2 + \gamma\mu L \tau \\
    &\cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]
\end{align*}

\begin{proposition} \label{proposition3.4}
Let Assumption \ref{assumption1} hold. Then, we have
\begin{align*}
    \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] &\leq \frac{q}{M^2}\sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] \\
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - \frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m})] &\leq \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{proposition3.4}} \textrm{ } First, let's consider the first inequality. According to Assumption \ref{assumption1}, we get
\begin{align*}
    \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] &= \mathbb{E}[\|w_k + \frac{1}{M} \sum_{m=1}^M Q(w_{k, \tau}^m - w_k) - \frac{1}{M} \sum_{m=1}^M w_{k, \tau}^m\|^2] \\
    &= \mathbb{E}[\|\frac{1}{M} \sum_{m=1}^M Q(w_{k, \tau}^m - w_k) - (w_{k, \tau}^m - w_k)\|^2] \\
    &= \frac{1}{M^2} \sum_{m=1}^M \mathbb{E}[\|Q(w_{k, \tau}^m - w_k) - (w_{k, \tau}^m -w_k)\|^2] \leq \frac{q}{M^2} \sum_{m=1}^M \mathbb{E} \|w_{k, \tau}^m - w_k\|^2
\end{align*}
The third equality comes from the unbiasedness of $Q$, and the last inequality stems from the variance assumption of $Q$. Similarly, we obtain

\begin{align*}
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - \frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m})] &= \mathbb{E}[F(w_k^{\textrm{ag}} + \frac{1}{M}\sum_{m=1}^M Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})) - \frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m})] \\
    &= \mathbb{E}[\frac{1}{M} \sum_{m=1}^M F(w_k^{\textrm{ag}} + \frac{1}{M}\sum_{m=1}^M Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})) - F(w_{k, \tau}^{\textrm{ag}, m})] \\
    &\leq \mathbb{E}\Big[\frac{1}{M} \sum_{m=1}^M \langle \nabla F(w_{k, \tau}^{\textrm{ag}, m}), \frac{1}{M} \sum_{m=1}^M \Big( Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} \\
    &- w_k^{\textrm{ag}})\Big) \rangle + \frac{L}{2} \|\frac{1}{M} \sum_{m=1}^M  Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2\Big] \\
    &= \frac{L}{2} \mathbb{E}[\|\frac{1}{M} \sum_{m=1}^M  Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2] \\
    &= \frac{L}{2M^2}\sum_{m=1}^M \mathbb{E}[\| Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2] \\
    &\leq \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]
\end{align*}

\begin{proposition} \label{proposition3.5}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], $ we get
\begin{align*}
    \mathbb{E}[A_{k, t}^m] \leq \mathbb{E}[A_{k, 0}^m] + \Big( \frac{(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu}+\frac{\gamma^2(\mu+L)^2 L}{\mu^2}\Big)\cdot \Big( 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big)\sigma^2
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{proposition3.5}}
\textrm{ } From the notation mentioned in the beginning of \cref{app:proofs},
\begin{align} \label{eq3.5-1}
    \mathbb{E}[A_{k, t+1}^m|\mathcal{F}_{k, t}] &= \frac{\gamma^2\mu^2 (\mu+L)}{(1+\gamma\mu)^2}\mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] + \gamma^2(\mu+L)\frac{2L}{1+\gamma\mu}\mathbb{E}[\Psi_{k, t+1}^m|\mathcal{F}_{k, t}]
\end{align}
Thus, let's sequentially compute $\mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}]$ and $\mathbb{E}[\Psi_{k, t+1}^m|\mathcal{F}_{k, t}]$.
\begin{align*}
    \mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] &= \mathbb{E}[\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma g_{k, t}^m - w_{k, t}^{\textrm{md}, m} + \eta g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \\
    &= \mathbb{E}[\|(1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}) - (\gamma-\eta)g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \textrm{ } (\leftarrow \gamma \geq \eta) \\
    &= \|(1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}) - (\gamma-\eta)\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &+ (\gamma - \eta)^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m}) - g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \\
    &\leq (1-\alpha^{-1})^2 \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 + (\gamma-\eta)^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &+ (\gamma-\eta)^2 \sigma^2 - 2(\gamma-\eta) \langle (1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}), \nabla F(w_{k, t}^{\textrm{md}, m})\rangle \\
    &\leq (1-\alpha^{-1})^2(1+\gamma\mu) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 \\
    &+ (\gamma-\eta)^2(1+\frac{1}{\gamma\mu}) \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + (\gamma-\eta)^2 \sigma^2 \\
    &= \frac{(1-\gamma\mu)^2}{1+\gamma\mu}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + (\gamma-\eta)^2\frac{1+\gamma\mu}{\gamma\mu}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + (\gamma-\eta)^2\sigma^2
\end{align*}
Here, we need to bound $\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2$.
\begin{align} \label{ineq3.5-2}
    \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 &\leq 2L(F(w_{k, t}^{\textrm{md}, m}) - F^*) \textrm{ }(\because \textrm{ Assumption \ref{assumption3}}) \nonumber\\
    &\leq 2L\Big(\beta^{-1}(F(w_{k, t}^m)-F(w^*))+(1-\beta^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*)\Big) \nonumber\\
    &\leq \beta^{-1}L^2 \|w_{k, t}^m - w^*\|^2 + 2(1-\beta^{-1})L(F(w_{k, t}^{\textrm{ag}, m})-F^*) \nonumber\\
    &= \frac{\gamma\mu L^2}{1+\gamma\mu}\|w_{k, t}^m - w^*\|^2 + \frac{2L}{1+\gamma\mu}(F(w_{k, t}^{\textrm{ag}, m})-F^*) \nonumber\\
    &\leq \frac{\mu L}{1+\gamma\mu}\|w_{k, t}^m - w^*\|^2 + \frac{2L}{1+\gamma\mu}(F(w_{k, t}^{\textrm{ag}, m})-F^*) = \frac{2L}{1+\gamma\mu}\Psi_{k, t}^m
\end{align}
The last inequality comes from the fact $\gamma \in [0, \frac{1}{L})$. Therefore, we finally get
\begin{align} \label{ineq3.5-3}
    \mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] &\leq \frac{(1-\gamma\mu)^2}{1+\gamma\mu}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + (\gamma-\eta)^2\frac{1+\gamma\mu}{\gamma\mu}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + (\gamma-\eta)^2\sigma^2 \nonumber\\
    &\leq \frac{(1-\gamma\mu)^2}{1+\gamma\mu}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + (\gamma-\eta)^2\frac{1+\gamma\mu}{\gamma\mu}\Big(\frac{2L}{1+\gamma\mu}\Psi_{k, t}^m\Big) + (\gamma-\eta)^2\sigma^2
\end{align}
Now, let's compute $\mathbb{E}[\Psi_{k, t+1}^m|\mathcal{F}_{k, t}]$. We need to compute $\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}]$ and $\mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}]$ first.
\begin{align*}
    \mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}] &= \mathbb{E}[\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma g_{k, t}^m -w^*\|^2|\mathcal{F}_{k, t}] \\
    &\leq \|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*\|^2 + \gamma^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \gamma^2\sigma^2 \\
    &- 2\gamma \langle (1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle \\
    &\leq (1-\alpha^{-1})\|w_{k, t}^m -w^*\|^2 + \alpha^{-1}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2+ \gamma^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \gamma^2\sigma^2 \\
    &- 2\gamma \langle (1-\alpha^{-1}(1-\beta^{-1}))w_{k, t}^m + \alpha^{-1}(1-\beta^{-1})w_{k, t}^{\textrm{ag}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle \\
    &= (1-\gamma\mu)\|w_{k, t}^m -w^*\|^2 + \gamma\mu\|w_{k, t}^{\textrm{md}, m}-w^*\|^2+ \gamma^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \gamma^2\sigma^2 \\
    &- 2\gamma \langle \frac{1}{1+\gamma\mu}w_{k, t}^m + \frac{\gamma\mu}{1+\gamma\mu}w_{k, t}^{\textrm{ag}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle
\end{align*}
\begin{align*}
    \mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - &F^* |\mathcal{F}_{k, t}] \\
    &\leq \mathbb{E}[F(w_{k, t}^{\textrm{md}, m}) + \langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t+1}^{\textrm{ag}, m} - w_{k, t}^{\textrm{md}, m} \rangle + \frac{L}{2}\|w_{k, t+1}^{\textrm{ag}, m} - w_{k, t}^{\textrm{md}, m}\|^2 - F^*|\mathcal{F}_{k, t}] \\
    &\leq F(w_{k, t}^{\textrm{md}, m}) -F^* - \eta\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &\leq F(w_{k, t}^{\textrm{md}, m}) -F^* - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \textrm{ }(\because 1-\frac{\eta L}{2} \geq \frac{1}{2} \leftarrow \eta \in [0, \frac{1}{L}]) \\
    &= (1-\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) + \alpha^{-1}(F(w_{k, t}^{\textrm{md}, m}) -F^*) \\
    &+ (1-\alpha^{-1})(F(w_{k, t}^{\textrm{md}, m}) - F(w_{k, t}^{\textrm{ag}, m})) - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2
\end{align*}


\begin{align*}
    &\leq (1-\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) - \frac{\mu\alpha^{-1}}{2}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2 + \alpha^{-1} \langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t}^{\textrm{md}, m}-w^*\rangle \\
    &+ (1-\alpha^{-1})\langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t}^{\textrm{md}, m} - w_{k, t}^{\textrm{ag}, m}\rangle - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &= (1-\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) - \frac{\mu\alpha^{-1}}{2}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2 - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &+ \alpha^{-1} \langle \nabla F(w_{k, t}^{\textrm{md}, m}), \alpha\beta^{-1}w_{k, t}^m + (1 - \alpha\beta^{-1})w_{k, t}^{\textrm{ag}, m} - w^*\rangle \\
    &= (1-\gamma\mu)(F(w_{k, t}^{\textrm{ag}, m})-F^*) - \frac{\gamma\mu^2}{2}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2 - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &+ \gamma\mu\langle \frac{1}{1+\gamma\mu}w_{k, t}^m + \frac{\gamma\mu}{1+\gamma\mu}w_{k, t}^{\textrm{ag}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle
\end{align*}
Then, we bound $\mathbb{E}[\Psi_{k, t+1}^m|\mathcal{F}_{k, t}]$ by using the above results.
\begin{align} \label{ineq3.5-4}
    \mathbb{E}[\Psi_{k, t+1}^m|\mathcal{F}_{k, t}] &= \frac{\mu}{2}\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}] + \mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}] \nonumber\\
    &\leq (1-\gamma\mu)\Psi_{k, t}^m - \frac{\eta - \gamma^2\mu}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\gamma^2\mu + \eta^2 L}{2}\sigma^2 \nonumber\\
    &\leq (1-\gamma\mu)\Psi_{k, t}^m  + \frac{\gamma^2\mu + \eta^2 L}{2}\sigma^2 \textrm{ }(\because \gamma \leq \sqrt{\frac{\eta}{\mu}}) \nonumber\\
    &\leq (1-\gamma\mu)\Psi_{k, t}^m  + \frac{\gamma^2(\mu+L)}{2}\sigma^2
\end{align}
Plugging (\ref{ineq3.5-3}), (\ref{ineq3.5-4}) in (\ref{eq3.5-1}) yields,
\begin{align} \label{ineq3.5-5}
    &\mathbb{E}[A_{k, t+1}^m|\mathcal{F}_{k, t}] \nonumber\\
    &\leq \frac{\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2}\bigg(\frac{(1-\gamma\mu)^2}{1+\gamma\mu}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + (\gamma-\eta)^2\frac{1+\gamma\mu}{\gamma\mu}\Big(\frac{2L}{1+\gamma\mu}\Psi_{k, t}^m\Big) + (\gamma-\eta)^2\sigma^2\bigg) \nonumber\\
    &+ \gamma^2(\mu+L)\frac{2L}{1+\gamma\mu}\Big((1-\gamma\mu)\Psi_{k, t}^m+\frac{\gamma^2(\mu+L)}{2}\sigma^2\Big) \nonumber\\
    &= \frac{(1-\gamma\mu)^2}{1+\gamma\mu}\cdot\frac{\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2}\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + \Big(\frac{\gamma\mu(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu} +\gamma^2(\mu+L)(1-\gamma\mu)\Big)\frac{2L}{1+\gamma\mu}\Psi_{k, t}^m \nonumber\\
    &+ \Big(\frac{\gamma^2\mu^2(\gamma-\eta)^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\sigma^2
\end{align}
Since $\eta \leq \gamma$, we get $(\gamma-\eta)^2 \leq \gamma^2$. By using this fact, we obtain
\begin{align} \label{ineq3.5-6}
    \frac{\gamma\mu(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu} +\gamma^2(\mu+L)(1-\gamma\mu) &\leq \frac{\gamma^3\mu(\mu+L)}{1+\gamma\mu} +\gamma^2(\mu+L)(1-\gamma\mu) \nonumber\\
    &= \gamma^2(\mu+L)(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})
\end{align}
It is easy to show that $1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu}<1$. Also, we get
\begin{align} \label{ineq3.5-7}
    \frac{(1-\gamma\mu)^2}{1+\gamma\mu} < 1-\gamma\mu < 1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu}
\end{align}
From (\ref{ineq3.5-5}), (\ref{ineq3.5-6}), and (\ref{ineq3.5-7}) we finally get
\begin{align*}
    \mathbb{E}[A_{k, t+1}^m|\mathcal{F}_{k, t}] &\leq (1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})A_{k, t}^m + \Big(\frac{\gamma^2\mu^2(\gamma-\eta)^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\sigma^2
\end{align*}
From this relationship between $A_{k, t+1}^m$ and $A_{k, t}^m$, we obtain the result of Proposition \ref{proposition3.5}.
\begin{align*}
    &\mathbb{E}[A_{k, t}^m] \\
    &\leq (1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\mathbb{E}[A_{k, 0}^m] + \Big(\frac{\gamma^2\mu^2(\gamma-\eta)^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\sigma^2 \cdot \frac{1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t}{1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})} \\
    &= (1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\mathbb{E}[A_{k, 0}^m] + \Big( \frac{(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu}+\frac{\gamma^2(\mu+L)^2 L}{\mu^2}\Big)\sigma^2 \cdot \Big(1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big) \\
    &\leq \mathbb{E}[A_{k, 0}^m] + \Big( \frac{(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu}+\frac{\gamma^2(\mu+L)^2 L}{\mu^2}\Big)\cdot \Big( 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big)\sigma^2
\end{align*}

\begin{proposition} \label{proposition3.6}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \tau \geq 2,$ FedAQ yields
\begin{align*}
    \frac{\mu}{2}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &\leq \Big( \frac{4\gamma^2\mu(\mu+L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2 \mathbb{E}[\Psi_k] + (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( \frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu} \Big) \frac{\tau^3\sigma^2}{2}
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{proposition3.6}} \textrm{ } Let's first bound $\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2]$ and $\mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]$ individually.
\begin{align*}
    \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] &= \mathbb{E}[\|(w_{k, \tau}^m-w_{k, \tau-1}^m) +\cdots+ (w_{k, 1}^m - w_{k, 0}^m)\|^2] \\
    &= \mathbb{E}\Big[\Big\|\sum_{t=0}^{\tau-1}\Big((1-\alpha^{-1})w_{k, t}^m+\alpha^{-1}w_{k, t}^{\textrm{md, m}}-w_{k, t}^m-\gamma g_{k, t}^m\Big)\Big\|^2\Big] \\
    &= \mathbb{E}\Big[\Big\|\alpha^{-1}\sum_{t=0}^{\tau-1}(w_{k, t}^{\textrm{md}, m}-w_{k, t}^m) - \gamma\sum_{t=0}^{\tau-1}g_{k, t}^m\Big\|^2\Big] \\
    &\leq 2\alpha^{-2}\mathbb{E}[\|\sum_{t=0}^{\tau-1}(w_{k, t}^{\textrm{md}, m}-w_{k, t}^m)\|^2] + 2\gamma^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}g_{k, t}^m\|^2]\\
    &\leq 2\alpha^{-2}\tau\sum_{t=0}^{\tau-1}\mathbb{E}[\|w_{k, t}^{\textrm{md}, m}-w_{k, t}^m\|^2] + 2\gamma^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}\nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \\
    &+ 2\gamma^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}(g_{k, t}^m - \nabla F(w_{k, t}^{\textrm{md}, m}))\|^2]\\
    &\leq 2\alpha^{-2}(1-\beta^{-1})^2\tau\sum_{t=0}^{\tau-1}\mathbb{E}[\|w_{k, t}^m-w_{k, t}^{\textrm{ag}, m}\|^2] + 2\gamma^2\tau\sum_{t=0}^{\tau-1}\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
    &+ 2\gamma^2\sum_{t=0}^{\tau-1}\mathbb{E}[\|g_{k, t}^m - \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
    &= \tau \Big(\sum_{t=0}^{\tau-1} 2\alpha^{-2}(1-\beta^{-1})^2\mathbb{E}[\|w_{k, t}^m- w_{k, t}^{\textrm{ag}, m}\|^2 ] + 2\gamma^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big) +2\tau\gamma^2\sigma^2
\end{align*}
\begin{align*}
    \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &= \mathbb{E}[\|\sum_{t=0}^{\tau-1}(w_{k, t+1}^{\textrm{ag}, m}-w_{k, t}^{\textrm{ag}, m})\|^2] \\
    &= \mathbb{E}[\|\sum_{t=0}^{\tau-1}(w_{k, t}^{\textrm{md}, m}-w_{k, t}^{\textrm{ag}, m}-\eta g_{k, t}^m)\|^2]\\
    &\leq 2\mathbb{E}[\|\sum_{t=0}^{\tau-1}(w_{k, t}^{\textrm{md}, m} - w_{k, t}^{\textrm{ag}, m})\|^2] + 2\eta^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}g_{k, t}^m\|^2]\\
    &= 2\beta^{-2}\mathbb{E}[\|\sum_{t=0}^{\tau-1}(w_{k, t}^m - w_{k, t}^{\textrm{ag}, m})\|^2] + 2\eta^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}\nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \\
    &+ 2\eta^2\mathbb{E}[\|\sum_{t=0}^{\tau-1}(g_{k, t}^m - \nabla F(w_{k, t}^{\textrm{md}, m}))\|^2]\\
    &\leq 2\beta^{-2}\tau\sum_{t=0}^{\tau-1}\mathbb{E}[\|w_{k, t}^m-w_{k, t}^{\textrm{ag}, m}\|^2] + 2\eta^2\tau\sum_{t=0}^{\tau-1}\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
    &+ 2\eta^2\sum_{t=0}^{\tau-1}\mathbb{E}[\|g_{k, t}^m - \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
    &= \tau \Big(\sum_{t=0}^{\tau-1} 2\beta^{-2}\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + 2\eta^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big) +2\tau\eta^2\sigma^2
\end{align*}
Thus, by using the above results, we get
\begin{align*}
    &\frac{\mu}{2}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq \tau \sum_{t=0}^{\tau-1} \Big\{ \Big(\mu\alpha^{-2}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + (\gamma^2\mu + \eta^2 L)\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big\} \\
    &+ (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &\leq \tau \sum_{t=0}^{\tau-1} \Big\{ \Big(\mu\alpha^{-2}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + (\gamma^2\mu + \eta^2 L)\frac{2L}{1+\gamma\mu}\mathbb{E}[\Psi_{k, t}^m]\Big\} \\
    &+ (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \textrm{ }(\because (\ref{ineq3.5-2})) \\
    &\leq \tau \sum_{t=0}^{\tau-1} \Big\{ \frac{\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2}\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + \gamma^2(\mu+L)\frac{2L}{1+\gamma\mu}\mathbb{E}[\Psi_{k, t}^m]\Big\} + (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &= \tau \Big( \sum_{t=0}^{\tau-1} \mathbb{E}[A_{k, t}^m]\Big) + (\gamma^2\mu+\eta^2 L)\tau\sigma^2
\end{align*}
By Proposition \ref{proposition3.5} and the fact $\Psi_{k, 0}^m = \Psi_k$, we obtain
\begin{align*}
    &\frac{\mu}{2}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq \tau \Big\{ \sum_{t=0}^{\tau-1} \mathbb{E}[A_{k, 0}^m] + \Big( \frac{(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu}+\frac{\gamma^2(\mu+L)^2 L}{\mu^2}\Big) \cdot \Big( 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big)\sigma^2 \Big\} \\
    &+ (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &= \tau^2 \Big(\frac{\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2}\mathbb{E}[\|w_k-w_k^{\textrm{ag}}\|^2]+\gamma^2(\mu+L)\frac{2L}{1+\gamma\mu}\mathbb{E}[\Psi_k]\Big) \\
    &+ \tau \Big( \frac{(\gamma-\eta)^2(\mu+L)}{1+\gamma\mu}+\frac{\gamma^2(\mu+L)^2 L}{\mu^2}\Big) \Big(\sum_{t=0}^{\tau-1} 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big)\sigma^2 + (\gamma^2\mu+\eta^2 L)\tau\sigma^2
\end{align*}
Before we get to the final result, let's find the upper bound for $\|w_k - w_k^{\textrm{ag}}\|^2$, $\sum_{t=0}^{\tau-1}\Big( 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big)$
\begin{align*}
    \|w_k - w_k^{\textrm{ag}}\|^2 &= \|w_k - w^* -(w_k^{\textrm{ag}}-w^*)\|^2 \nonumber\\
    &\leq 2\|w_k - w^*\|^2 + 2\|w_k^{
    \textrm{ag}}-w^*\|^2 \nonumber\\
    &\leq 2\|w_k - w^*\|^2 + 2\cdot \frac{2}{\mu}\Big(F(w_k^{\textrm{ag}})-F^*-\langle\nabla F(w^*),w_k^{\textrm{ag}}-w^*\rangle\Big) \nonumber\\
    &= 2\|w_k-w^*\|^2 + \frac{4}{\mu}(F(w_k^{\textrm{ag}})-F^*) = \frac{4}{\mu}\Psi_k
\end{align*}
\begin{align*}
    \sum_{t=0}^{\tau-1}\Big( 1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t\Big) &= \tau - \sum_{t=0}^{\tau-1} (1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^t \\
    &= \tau - \frac{1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})^\tau}{1-(1-\gamma\mu+\frac{\gamma\mu}{1+\gamma\mu})} \\
    &\leq \tau - \frac{1-(1-\frac{\gamma^2\mu^2}{1+\gamma\mu}\tau + (\frac{\gamma^2\mu^2}{1+\gamma\mu})^2\frac{\tau(\tau-1)}{2})}{\frac{\gamma^2\mu^2}{1+\gamma\mu}} \\
    &= \frac{\gamma^2\mu^2}{1+\gamma\mu}\cdot\frac{\tau(\tau-1)}{2} \leq \frac{\gamma^2\mu^2}{1+\gamma\mu}\cdot\frac{\tau^2}{2}
\end{align*}
Therefore, we conclude as below
\begin{align*}
    \frac{\mu}{2}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &\leq \Big( \frac{4\gamma^2\mu(\mu+L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2 \mathbb{E}[\Psi_k] + (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( \frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu} \Big) \frac{\tau^3\sigma^2}{2}
\end{align*}

\emph{Proof of Lemma \ref{lemma3.1}} \textrm{ } By the definition of $\Psi_k, \Psi_{k, t}$ and Proposition \ref{proposition3.2},
\begin{gather*}
    \mathbb{E}[\Psi_{k+1}] = \mathbb{E}[\Psi_{k, \tau}] + \frac{\mu}{2}\mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] + \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - \frac{1}{M} \sum_{m=1}^M F(w_{k, \tau}^{\textrm{ag}, m})]
\end{gather*}
Applying Proposition \ref{proposition3.3} and Proposition \ref{proposition3.4}, we have
\begin{align*}
    &\mathbb{E}[\Psi_{k+1}] \\
    &\leq (1-\gamma\mu)^\tau \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\tau\sigma^2 \\
    &+ \gamma\mu L \tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|] \\
    &+ \frac{q\mu}{2M^2}\sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq (1-\gamma\mu)^\tau \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L + \frac{\gamma^2\mu}{M})\tau\sigma^2 \\
    &+ \gamma\mu L \tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|] \\
    &+ \frac{q}{M}\Big[ \Big( \frac{4\gamma^2\mu(\mu+L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2 \mathbb{E}[\Psi_k] + (\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( \frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu} \Big) \frac{\tau^3\sigma^2}{2}\Big] \\
    &= \Big\{(1-\gamma\mu)^\tau + \frac{q}{M}\Big( \frac{4\gamma^2\mu(\mu + L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2\Big\} \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2\\
     &+ \frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2\\
     &+ \gamma\mu L \tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]
\end{align*}
The second inequality comes from Proposition \ref{proposition3.6}. Then, let's define $C(\gamma, \tau)$ as
\begin{align*}
    C(\gamma, \tau) &= (1-\gamma\mu)^\tau + \frac{q}{M}\Big( \frac{4\gamma^2\mu(\mu + L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2
\end{align*}
Finally, we obtain
\begin{align*}
    \mathbb{E}[\Psi_{k+1}] &\leq C(\gamma, \tau)\mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2 + \frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 \\
    &+ \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2 + \gamma\mu L \tau \\
    &\cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]
\end{align*}

\subsubsection{Proof of Theorem \ref{theorem1}}
\label{app:proof_theorem}

\begin{theorem} \label{theorem1}
    Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{1}{\gamma\mu}, \beta=\alpha+1, \gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}}), \eta, \gamma \in (0, \frac{1}{L}], \tau \geq 2, $ if the learning rate $\gamma$ satisfies
    \begin{align} \label{condition1}
        \Big(\mu^2 + \frac{q}{M}(\mu+L)(4\mu+2L)\Big)\gamma\tau \leq \frac{1}{2}\mu
    \end{align}
    FedAQ yields
    \begin{align*}
        &\mathbb{E}[\Psi_K] \leq \exp{\Big(-\frac{1}{2}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Psi_0 + (2q+1)(\frac{\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{\eta\sigma^2}{M}) + 14\eta^2 L\tau\sigma^2 \\
        &+ \frac{(780+\frac{2q}{M})\eta^{\frac{3}{2}}L\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}} + \frac{(\mu+L)(\mu^2+\mu L+L^2)q\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{q\eta^3\tau^2(\mu+L)^2 L\sigma^2}{\mu M}
    \end{align*}
\end{theorem}

\emph{Proof of Theorem \ref{theorem1} } At first, due to the condition (\ref{condition1}) in Theorem \ref{theorem1}, we get
\begin{align*}
    C(\gamma, \tau) &= (1-\gamma\mu)^\tau + \frac{q}{M}\Big( \frac{4\gamma^2\mu(\mu + L)}{(1+\gamma\mu)^2} + \frac{2L\gamma^2(\mu+L)}{1+\gamma\mu}\Big)\tau^2 \\
    &\leq 1-\gamma\mu\tau+\gamma^2\mu^2\tau^2 + \frac{q}{M}\gamma^2(\mu+L)(4\mu+2L)\tau^2 \\
    &= 1-\gamma\mu\tau + \Big(\mu^2+\frac{q}{M}(\mu+L)(4\mu+2L)\Big)\gamma^2\tau^2 \\
    &\leq 1 - \frac{1}{2}\gamma\mu\tau \textrm{ }(\because \textrm{ condition } (\ref{condition1}))
\end{align*}
The first inequality comes from the fact that $(1-\gamma\mu)^\tau \leq e^{-\gamma\mu\tau} \leq 1-\gamma\mu\tau+\gamma^2\mu^2\tau^2$ when $0 \leq \gamma\mu \leq 1$.
Also, it is trivial that $\gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}}) \in [\eta, \sqrt{\frac{\eta}{\mu}}]$. Thus, we can use Lemma \ref{lemma3.1}. By using Lemma \ref{lemma3.1} and the above result, we obtain
\begin{align} \label{ineq3.7-1}
    \mathbb{E}[\Psi_{k+1}] &\leq (1-\frac{1}{2}\gamma\mu\tau) \mathbb{E}[\Psi_k] + \frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2\nonumber\\
     &+ \frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2 + \gamma\mu L \tau \nonumber\\
     &\cdot \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|]
\end{align}
By the Lemma B.3 in \cite{yuan2020federated}, we know that the below quantity is bounded.
\begin{gather*}
    \max_{0\leq t <\tau} \mathbb{E}[\frac{1}{M} \sum_{m=1}^M \|\Bar{w}_{k, t}^{\textrm{md}} - w_{k, t}^{\textrm{md}, m}\|\|\frac{1}{1+\gamma\mu}(\Bar{w}_{k, t} - w_{k, t}^m) + \frac{\gamma\mu}{1+\gamma\mu}(\Bar{w}_{k, t}^{\textrm{ag}} - w_{k, t}^{\textrm{ag}, m})\|] \leq B \\
    B=
    \begin{cases}
    7\eta\gamma\tau\sigma^2\Big(1+\frac{2\gamma^2\mu}{\eta}\Big)^{2\tau},~\textrm{ if } \gamma \in \Big(\eta, \sqrt{\frac{\eta}{\mu}}\Big]\\
    7\eta^2\tau\sigma^2,~\textrm{ if } \gamma=\eta
    \end{cases}
\end{gather*}
Telescoping (\ref{ineq3.7-1}) yields
\begin{align*}
    \mathbb{E}[\Psi_{K}] &\leq (1-\frac{1}{2}\gamma\mu\tau)^K\Psi_0 + \Big(\sum_{k^\prime=0}^{K-1}(1-\frac{1}{2}\gamma\mu\tau)^{k^\prime}\Big)\cdot \Big[\frac{1}{2}(\eta^2 L+\frac{\gamma^2\mu}{M})\tau\sigma^2+ \gamma\mu L \tau B\\
     &+ \frac{q}{M}(\gamma^2\mu+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big(\frac{(\gamma-\eta)^2\gamma^2\mu^2(\mu+L)}{(1+\gamma\mu)^2} + \frac{\gamma^4(\mu+L)^2 L}{1+\gamma\mu}\Big)\tau^3\sigma^2 \Big] \\
     &\leq \exp\Big(-\frac{\gamma\mu\tau K}{2}\Big)\Psi_0 + \frac{\eta^2 L\sigma^2}{\gamma\mu} + \frac{\gamma\sigma^2}{M} + 2LB + 2q\Big(\frac{\gamma\sigma^2}{M}+\frac{\eta^2 L\sigma^2}{\gamma\mu M}\Big) \\
     &+ \frac{q}{M}\Big(\frac{(\gamma-\eta)^2 \gamma\mu(\mu+L)}{(1+\gamma\mu)^2}+\frac{\gamma^3(\mu+L)^2 L}{(1+\gamma\mu)\mu}\Big)\tau^2\sigma^2
\end{align*}
The last inequality comes from the fact that $\sum_{k^\prime=0}^{K-1}(1-\frac{1}{2}\gamma\mu\tau)^{k^\prime} \leq \frac{2}{\gamma\mu\tau}$. Since we plug in $\gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}})$, we can use Lemma B.4 in \cite{yuan2020federated}. Therefore, we obtain
\begin{align*}
    \mathbb{E}[\Psi_K] &\leq \exp{\Big(-\frac{1}{2}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Psi_0 + \frac{\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{\eta\sigma^2}{M} + \frac{780\eta^{\frac{3}{2}}L \tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}}+14\eta^2 L\tau\sigma^2 \\
    &+ \max\Big(\frac{2q\eta^{\frac{1}{2}}\sigma^2}{M\mu^{\frac{1}{2}}\tau^{\frac{1}{2}}}, \frac{2q\eta\sigma^2}{M}\Big) + \min\Big(\frac{2q\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}L \sigma^2}{M\mu^{\frac{1}{2}}}, \frac{2q\eta L \sigma^2}{M\mu}\Big) \\
    &+ \frac{q\tau^2\sigma^2}{M}\max\Big(\frac{\eta^{\frac{3}{2}}\mu(\mu+L)}{\mu^{\frac{3}{2}}\tau^{\frac{3}{2}}}+\frac{\eta^{\frac{3}{2}}(\mu+L)^2 L}{\mu^{\frac{5}{2}}\tau^{\frac{3}{2}}}, \frac{\eta^3 (\mu+L)^2 L}{\mu}\Big)
\end{align*}
The first term stems directly from Lemma B.4 in \cite{yuan2020federated}. Also, the last term comes from the fact that
\begin{align*}
    \frac{(\gamma-\eta)^2 \gamma\mu(\mu+L)}{(1+\gamma\mu)^2}+\frac{\gamma^3(\mu+L)^2 L}{(1+\gamma\mu)\mu} \leq
    \begin{cases}
    \gamma^3\mu(\mu+L) + \frac{\gamma^3(\mu+L)^2 L}{\mu},~\textrm{ if }\gamma \neq \eta\\
    \frac{\eta^3 (\mu+L)^2 L}{\mu},~\textrm{ if } \gamma=\eta
    \end{cases}
\end{align*}
Therefore, by simple inequalities such as $\max(a, b) \leq a+b$ and $\min(a, b) \leq a$, we ultimately get
\begin{align} \label{ineq_theorem1}
    \mathbb{E}[\Psi_K] &\leq \exp{\Big(-\frac{1}{2}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Psi_0 + \frac{(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{(2q+1)\eta\sigma^2}{M} + 14\eta^2 L\tau\sigma^2 \nonumber\\
        &+ \frac{(780+\frac{2q}{M})\eta^{\frac{3}{2}}L\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}} + \frac{(\mu+L)(\mu^2+\mu L+L^2)q\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{q\eta^3\tau^2(\mu+L)^2 L\sigma^2}{\mu M}
\end{align}

\subsubsection{Proof of Corollary \ref{corollary1}}
\label{app:proof_corollary}

\begin{corollary} \label{corollary1}
    Let $C_1, C_2,\textrm{ and } \eta_0$ as below. Note that $T = K\tau$.
    \begin{align*}
        C_1 &= \frac{(\mu+L)(\mu^2+\mu L+L^2)q}{\mu^{\frac{5}{2}}}, \textrm{ } C_2 = \frac{q(\mu+L)^2 L}{\mu} \\
        \eta_0 &= \frac{4\tau}{\mu T^2}\log^2\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big)
    \end{align*}
    Then for $\eta = \min(\frac{1}{L}, \eta_0)$, FedAQ yields
    \begin{align}
        &\mathbb{E}[\Psi_K] \leq \min \Big( \exp(-\frac{\mu T}{2L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{2 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Psi_0 \nonumber \\
        &+ \frac{7(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) \\
        &+ \frac{(6465+\frac{16q}{M})L\tau^2\sigma^2}{\mu^2 T^3}\log^4 \Big(e+ \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) \\
        &+ \frac{9(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big)
    \end{align}
\end{corollary}

\emph{Proof of Corollary \ref{corollary1}} \textrm{ } Let's decompose the final result (\ref{ineq_theorem1}) of the Theorem \ref{theorem1} into a decreasing term and an increasing term. We denote the decreasing term $\psi_1$ and the increasing term $\psi_2$ as below.
\begin{align*}
    \psi_1(\eta) &= \exp\Big( -\frac{1}{2}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})T \Big)\Psi_0 \\
    \psi_2(\eta) &= \frac{(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{(2q+1)\eta\sigma^2}{M} + \frac{(780+\frac{2q}{M})\eta^{\frac{3}{2}}L\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}} + 14\eta^2 L\tau\sigma^2 \\
    &+ \frac{(\mu+L)(\mu^2+\mu L+L^2)q\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{q\eta^3\tau^2(\mu+L)^2 L\sigma^2}{\mu M}
\end{align*}
Since $\psi_1$ is the decreasing term, we have
\begin{align} \label{ineq_corollary1-1}
    \psi_1(\eta) \leq \psi_1(\frac{1}{L}) + \psi_1(\eta_0)
\end{align}
where
\begin{align*}
    \psi_1(\frac{1}{L}) &= \min \Big( \exp(-\frac{\mu T}{2L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{2 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Psi_0 \\
    \psi_1(\eta_0) &\leq \exp \Big( -\frac{1}{2} \sqrt{\frac{\eta_0 \mu}{\tau}}T\Big) \\
    &= \Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big)^{-1} \Psi_0 \\
    &\leq \frac{(2q+1)\sigma^2}{\mu MT} + \frac{L\tau^2\sigma^2}{\mu^2 T^3} + \frac{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}{\mu^3 M T^3}
\end{align*}
Since $\psi_2$ is the increasing term, we have
\begin{align} \label{ineq_corollary1-2}
    &\psi_2(\eta) \nonumber\\
    &\leq \psi_2(\eta_0) \nonumber\\
    &\leq \frac{2(2q+1)\sigma^2}{\mu MT}\log\Big(e+\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) + \frac{4(2q+1)\tau\sigma^2}{\mu MT^2} \log^2\Big(e+\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) \nonumber\\
    &+ \frac{8(780+\frac{2q}{M})L\tau^2\sigma^2}{\mu^2 T^3} \log^3\Big(e+\frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) + \frac{224L\tau^3\sigma^2}{\mu^2 T^4}\log^4\Big(e+\frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) \nonumber\\
    &+ \frac{8C_1 \tau^2\sigma^2}{\mu^{\frac{3}{2}}MT^3}\log^3\Big(e+\frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big) + \frac{64C_2\tau^5\sigma^2}{\mu^3 MT^6} \log^6\Big(e+ \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big) \nonumber\\
    &\leq \frac{6(2q+1)\sigma^2}{\mu MT}\log^2\Big(e+\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) + \frac{(6464+\frac{16q}{M})L\tau^2\sigma^2}{\mu^2 T^3} \log^4\Big(e+\frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) \nonumber\\
    &+ \frac{8(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big)
\end{align}
The last inequality comes from $\frac{\tau}{T} \leq 1$. Therefore, by combining (\ref{ineq_corollary1-1}) and (\ref{ineq_corollary1-2}), we finally get
\begin{align*}
    \mathbb{E}[\Psi_K] &\leq \psi_1(\eta) + \psi_2(\eta) \\
    &\leq \psi_1(\frac{1}{L}) + \psi_1(\eta_0) + \psi_2(\eta_0) \\
    &\leq \min \Big( \exp(-\frac{\mu T}{2L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{2 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Psi_0 + \frac{7(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}\Big) \\
        &+ \frac{(6465+\frac{16q}{M})L\tau^2\sigma^2}{\mu^2 T^3}\log^4 \Big(e+ \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}\Big) \\
        &+ \frac{9(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}\Big)
\end{align*}

\subsubsection{Why the Condition (\ref{condition1}) is Satisfied}
\label{app:proof_condition2}

The synchronization rounds $K$ required for linear speedup in $M$ for FedAQ is $\Tilde{\mathcal{O}}((\frac{M}{1+q})^{\frac{1}{2}})$ (See Remark \ref{remark5.4}). Since we derive this result from Theorem \ref{theorem1}, we should show that $K = \Tilde{\mathcal{O}}((\frac{M}{1+q})^{\frac{1}{2}})$ satisfies the condition (\ref{condition1}) in Theorem \ref{theorem1}.
\begin{align*}
     \Big(\mu^2 + \frac{q}{M}(\mu+L)(4\mu+2L)\Big)\gamma\tau \leq \frac{1}{2}\mu
\end{align*}
We rewrite the above condition as below.
\begin{align} \label{theorem1_condition}
    \gamma\tau \leq \frac{\mu}{2\mu^2+\frac{2q}{M}(\mu+L)(4\mu+2L)}
\end{align}
We know $\gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}})$ and $\eta = \min(\frac{1}{L}, \eta_0)$. Since $\eta_0$ becomes smaller and smaller as T increases, we assume $\eta = \eta_0$ here. Therefore, we get
\begin{align*}
    \gamma\tau &= \max(\eta_0\tau, \sqrt{\frac{\eta_0\tau}{\mu}}) \\
    &= \max\Big(\frac{4\tau^2}{\mu T^2}\log^2\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big), \\
    &\frac{2\tau}{\mu T}\log\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big)\Big)
\end{align*}
Note that $K=\frac{T}{\tau}=\Tilde{\mathcal{O}}((\frac{M}{1+q})^{\frac{1}{2}})=C(\frac{M}{1+q})^{\frac{1}{2}} \log(T)$ because $\Tilde{\mathcal{O}}$ contains hidden multiplicative polylog factors with respect to $T$. We can assume $T$ is sufficiently large here. Then, we have
\begin{align*}
    \gamma\tau &= \max\Big(\frac{4(1+q)}{\mu C^2M\log^2(T)}\log^2\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big), \\
    &\frac{2(1+q)^{\frac{1}{2}}}{\mu CM^{\frac{1}{2}}\log(T)}\log\Big(e+\min(\frac{\mu M T \Psi_0}{(2q+1)\sigma^2}, \frac{\mu^2 T^3\Psi_0}{L\tau^2\sigma^2}, \frac{\mu^3 M T^3\Psi_0}{(\mu^{\frac{3}{2}}C_1+8C_2)\tau^2\sigma^2}) \Big)\Big) \\
    &\leq \max\Big(\frac{4(1+q)}{\mu C^2M\log^2(T)}\log^2\Big(\frac{2\mu M T \Psi_0}{(2q+1)\sigma^2}\Big), \frac{2(1+q)^{\frac{1}{2}}}{\mu CM^{\frac{1}{2}}\log(T)}\log\Big(\frac{2\mu M T \Psi_0}{(2q+1)\sigma^2} \Big)\Big)
\end{align*}
For an arbitrary constant $k_1 > 0$, it is easy to show that $\lim_{T \rightarrow \infty} \frac{\log(k_1 T)}{\log(T)} = 1$. Thus, we obtain
\begin{align*}
    \gamma\tau &\leq \max\Big(\frac{4(1+q)}{\mu C^2M\log^2(T)}\log^2\Big(\frac{2\mu M T \Psi_0}{(2q+1)\sigma^2}\Big), \frac{2(1+q)^{\frac{1}{2}}}{\mu CM^{\frac{1}{2}}\log(T)}\log\Big(\frac{2\mu M T \Psi_0}{(2q+1)\sigma^2} \Big)\Big) \\
    &\simeq \max\Big(\frac{4(1+q)}{\mu C^2M}, \frac{2(1+q)^{\frac{1}{2}}}{\mu CM^{\frac{1}{2}}}\Big) \\
    &\leq \frac{\mu}{2\mu^2+\frac{2q}{M}(\mu+L)(4\mu+2L)}
\end{align*}
Finally, we conclude that there exists a constant $C$ that meets the last inequality. Therefore, $K = \Tilde{\mathcal{O}}((\frac{M}{1+q})^{\frac{1}{2}})$ satisfies the condition (\ref{condition1}).

\subsection{Proof Details for FedAQ under Condition Set (\ref{parameter2_FedAQ})}
\label{app:proofs2}

We use notations defined in \cref{app:proofs} here as well. We newly define $\Phi_{k, t}^m, \Phi_{k, t}, \Phi_k, B_{k, t}^m$ as below.
\begin{align*}
    \Phi_{k, t}^m &= F(w_{k, t}^{\textrm{ag}, m}) - F^* + \frac{1}{6} \mu \|w_{k, t}^m - w^*\|^2\\
    \Phi_{k, t} &= F(\Bar{w}_{k, t}^{\textrm{ag}}) -F^* + \frac{1}{6} \mu \|\Bar{w}_{k, t} - w^*\|^2 \\
    \Phi_k :&= \Phi_{k, 0} = F(w_k^{\textrm{ag}}) - F^* + \frac{1}{6} \mu \|w_k - w^*\|^2 \\
    B_{k, t}^m &= \Big( \frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2 + \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m
    %\chi_{k, t}^m &= \frac{\mu}{2}\|w_{k, t}^m - w_k\|^2 + \frac{L}{2} \|w_{k, t}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2
\end{align*}

The flow of proof is similar to \cref{app:proofs}. We need one more condition $\gamma\mu \leq \frac{3}{4}$ to show the convergence of FedAQ under the parameter condition set (\ref{parameter2_FedAQ}).

\subsubsection{Proof of Lemma \ref{lemmaD.1}}
\label{app:proof_lemma2}

% \begin{lemma} \label{lemmaD.1}
%  Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \gamma\mu \leq \frac{3}{4},\tau \geq 2, $ FedAQ yields
%  \begin{align*}
%      &\mathbb{E}[\Phi_{k+1}] \\
%      &\leq D(\gamma, \tau) \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}})- \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
%      &+ \underbrace{\frac{q}{M}(\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big( (\gamma-\eta)^2 \gamma^2\mu^2 (\frac{\mu}{3} + \frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L \Big)\tau^3\sigma^2}_{\textrm{additional terms due to quantization}}
%  \end{align*}
%  Where $D(\gamma, \tau)$ is defined as
%  \begin{align*}
%      D(\gamma, \tau) &= (1-\frac{1}{3}\gamma\mu)^\tau + \underbrace{\frac{q}{M}\Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2 L(\frac{\mu}{3} + L)\Big)\tau^2}_{\textrm{additional terms due to quantization}}
%  \end{align*}
% \end{lemma}

In order to prove Lemma \ref{lemmaD.1}, we first introduce five crucial Propositions for proving Lemma \ref{lemmaD.1}. Then, we prove Lemma \ref{lemmaD.1} by using Propositions in the last part of this section.
\begin{proposition} \label{propositionD.2}
Let Assumption \ref{assumption1} hold and consider any $k$ synchronization round. Then, we can decompose the expectation as follows:
\begin{align*}
    \mathbb{E}[\|w_{k+1} - w^*\|^2] &= \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] + \mathbb{E}[\|\Bar{w}_{k, \tau} - w^*\|^2] \\
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F^*] &= \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F(\Bar{w}_{k, \tau}^{\textrm{ag}})] + \mathbb{E}[F(\Bar{w}_{k, \tau}^{\textrm{ag}}) - F^*]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{propositionD.2}} \textrm{ } The second equality is trivial. The first equality is the same as one in Proposition \ref{proposition3.2}.

\begin{proposition} \label{propositionD.3}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta \in (0, \frac{1}{L}]$, FedAQ yields
\begin{align*}
    \mathbb{E}[\Phi_{k, \tau}] &\leq (1-\frac{1}{3}\gamma\mu)^\tau \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} \\
    &+ \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{propositionD.3}} \textrm{ } We refer to the proof of Lemma C.2 in \cite{yuan2020federated}. There is no quantization between $\Phi_{k, \tau}$ and $\Phi_k$. Thus, we can directly apply useful inequalities in the proof of Lemma C.2 in \cite{yuan2020federated} to our proof. Then, we obtain
\begin{align*}
    \mathbb{E}[\Phi_{k, t+1}|\mathcal{F}_{k, t}] &\leq (1-\frac{1}{3}\gamma\mu) \Phi_{k, t} + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\sigma^2}{M} + \gamma\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2
\end{align*}
From the above relationship between $\Phi_{k, t+1}$ and $\Phi_{k, t}$, we get
\begin{align*}
    \mathbb{E}[\Phi_{k, \tau}] &\leq (1-\frac{1}{3}\gamma\mu)^\tau \mathbb{E}[\Phi_k] + \Big(\sum_{t=0}^{\tau-1} (1-\frac{1}{3}\gamma\mu)^t \Big)\cdot(\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\sigma^2}{M} \\
    &+ \gamma \sum_{t=0}^{\tau-1} \Big\{ (1-\frac{1}{3}\gamma\mu)^{\tau-t-1} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big\} \\
    &\leq (1-\frac{1}{3}\gamma\mu)^\tau \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} \\
    &+ \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]
\end{align*}

\begin{proposition} \label{propositionD.4}
Let Assumption \ref{assumption1} hold. Then, we have
\begin{align*}
    \mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] &\leq \frac{q}{M^2}\sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] \\
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F(\Bar{w}_{k, \tau}^{\textrm{ag}})] &\leq \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{propositionD.4}} \textrm{ } The first inequality is the same as one in Proposition \ref{proposition3.4}.
The proof of the second inequality is similar to Proposition \ref{proposition3.4} as well.
\begin{align*}
    \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F(\Bar{w}_{k, \tau}^{\textrm{ag}})] &= \mathbb{E}[F(w_k^{\textrm{ag}} + \frac{1}{M}\sum_{m=1}^M Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})) - F(\frac{1}{M}\sum_{m=1}^M w_{k, \tau}^{\textrm{ag}, m})] \\
    &\leq \mathbb{E}\Big[ \langle \nabla F(\frac{1}{M} \sum_{m=1}^M w_{k, \tau}^{\textrm{ag}, m}), \frac{1}{M} \sum_{m=1}^M \Big( Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) \\
    &- (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\Big) \rangle + \frac{L}{2} \|\frac{1}{M} \sum_{m=1}^M  Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2\Big] \\
    &= \frac{L}{2} \mathbb{E}[\|\frac{1}{M} \sum_{m=1}^M  Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2] \\
    &= \frac{L}{2M^2}\sum_{m=1}^M \mathbb{E}[\| Q(w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}) - (w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}})\|^2] \\
    &\leq \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]
\end{align*}

\begin{proposition} \label{propositionD.5}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \gamma\mu \leq \frac{3}{4},$ we get
\begin{align*}
    \mathbb{E}[B_{k, t}^m] &\leq \mathbb{E}[B_{k, 0}^m] + \bigg( \Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big)\cdot(\gamma - \eta)^2+ \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \bigg) \\
    &\cdot \frac{1 + \frac{1}{2}\alpha^{-1}}{\frac{1}{4}\alpha^{-2}} \cdot \Big( 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big)\sigma^2
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{propositionD.5}}
\textrm{ } From the notation mentioned in the beginning of \cref{app:proofs2},
\begin{align} \label{eqD.5-1}
    \mathbb{E}[B_{k, t+1}^m|\mathcal{F}_{k, t}] &= \Big( \frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] \nonumber\\
    &+ \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L\mathbb{E}[\Phi_{k, t+1}^m|\mathcal{F}_{k, t}]
\end{align}
Thus, let's sequentially compute $\mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}]$ and $\mathbb{E}[\Phi_{k, t+1}^m|\mathcal{F}_{k, t}]$.
\begin{align*}
    \mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] &= \mathbb{E}[\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma g_{k, t}^m - w_{k, t}^{\textrm{md}, m} + \eta g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \\
    &= \mathbb{E}[\|(1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}) - (\gamma-\eta)g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \textrm{ } (\leftarrow \gamma \geq \eta) \\
    &= \|(1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}) - (\gamma-\eta)\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &+ (\gamma - \eta)^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m}) - g_{k, t}^m\|^2|\mathcal{F}_{k, t}] \\
    &\leq (1-\alpha^{-1})^2 \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 + (\gamma-\eta)^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &+ (\gamma-\eta)^2 \sigma^2 - 2(\gamma-\eta) \langle (1-\alpha^{-1})(w_{k, t}^m - w_{k, t}^{\textrm{md}, m}), \nabla F(w_{k, t}^{\textrm{md}, m})\rangle \\
    &\leq (1-\alpha^{-1})^2(1+2\alpha^{-1}) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 \\
    &+ (\gamma-\eta)^2(1+\frac{\alpha}{2}) \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + (\gamma-\eta)^2 \sigma^2
\end{align*}
Here, we need to bound $\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2$.
\begin{align} \label{ineqD.5-2}
    \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 &\leq 2L(F(w_{k, t}^{\textrm{md}, m}) - F^*) \textrm{ }(\because \textrm{ Assumption \ref{assumption3}}) \nonumber\\
    &\leq 2L\Big(\beta^{-1}(F(w_{k, t}^m)-F(w^*))+(1-\beta^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*)\Big) \nonumber\\
    &\leq \beta^{-1}L^2 \|w_{k, t}^m - w^*\|^2 + 2(1-\beta^{-1})L(F(w_{k, t}^{\textrm{ag}, m})-F^*) \nonumber\\
    &= \frac{\alpha-1}{2\alpha^2-1} L^2 \|w_{k, t}^m - w^*\|^2 + 2L\cdot\frac{2\alpha^2-\alpha}{2\alpha^2-1}(F(w_{k, t}^{\textrm{ag}, m})-F^*) \nonumber\\
    &\leq \frac{\frac{\mu}{3}(2\alpha^2-\alpha)}{2\alpha^2-1} L \|w_{k, t}^m - w^*\|^2 + 2L\cdot\frac{2\alpha^2-\alpha}{2\alpha^2-1}(F(w_{k, t}^{\textrm{ag}, m})-F^*) \nonumber\\
    &= \frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m
\end{align}
It is easy to show $(\alpha-1)L \leq \frac{\mu}{3}(2\alpha^2-\alpha)$ by using the fact $\gamma L \leq 1$. Therefore, we finally get
\begin{align} \label{ineqD.5-3}
    &\mathbb{E}[\|w_{k, t+1}^m - w_{k, t+1}^{\textrm{ag}, m}\|^2|\mathcal{F}_{k, t}] \nonumber\\
    &\leq (1-\alpha^{-1})^2(1+2\alpha^{-1}) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 + (\gamma-\eta)^2(1+\frac{\alpha}{2}) \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + (\gamma-\eta)^2 \sigma^2 \nonumber\\
    &\leq (1-\alpha^{-1})^2(1+2\alpha^{-1}) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 + (\gamma-\eta)^2(1+\frac{\alpha}{2}) (\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m) \nonumber\\
    &+ (\gamma-\eta)^2 \sigma^2
\end{align}
Now, let's compute $\mathbb{E}[\Phi_{k, t+1}^m|\mathcal{F}_{k, t}]$. We need to compute $\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}]$ and $\mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}]$ first.
\begin{align*}
    &\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}] \\
    &= \mathbb{E}[\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma g_{k, t}^m -w^*\|^2|\mathcal{F}_{k, t}] \\
    &\leq \|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma\nabla F(w_{k, t}^{\textrm{md}, m}) -w^*\|^2 +\gamma^2\sigma^2 \\
    &\leq (1+\frac{1}{2}\alpha^{-1})\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - \gamma\nabla F(w_{k, t}^{\textrm{md}, m}) -w^*\|^2 +\gamma^2\sigma^2 \\
    &= (1+\frac{1}{2}\alpha^{-1})\|(1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*\|^2 + \gamma^2(1+\frac{1}{2}\alpha^{-1}) \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &- 2\gamma(1+\frac{1}{2}\alpha^{-1}) \langle (1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle + \gamma^2\sigma^2 \\
    &\leq (1+\frac{1}{2}\alpha^{-1})\Big((1-\alpha^{-1})\|w_{k, t}^m - w^*\|^2 + \alpha^{-1}\|w_{k, t}^{\textrm{md}, m} - w^*\|^2\Big) + \gamma^2(1+\frac{1}{2}\alpha^{-1}) \\
    &\cdot \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2  - 2\gamma(1+\frac{1}{2}\alpha^{-1}) \langle (1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle + \gamma^2\sigma^2
\end{align*}
It is easy to show $(1+\frac{1}{2}\alpha^{-1})(1-\alpha^{-1}) < 1-\frac{1}{2}\alpha^{-1}, 1+\frac{1}{2}\alpha^{-1} \leq \frac{3}{2}$. Due to these facts, we obtain
\begin{align*}
    &\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}] \\
    &\leq (1-\frac{1}{2}\alpha^{-1})\|w_{k, t}^m - w^*\|^2 + \frac{3}{2}\alpha^{-1}\|w_{k, t}^{\textrm{md}, m} - w^*\|^2 + \frac{3}{2}\gamma^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &- 2\gamma(1+\frac{1}{2}\alpha^{-1}) \langle (1-\alpha^{-1})w_{k, t}^m + \alpha^{-1}w_{k, t}^{\textrm{md}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle + \gamma^2\sigma^2 \\
    &\leq (1-\frac{1}{2}\alpha^{-1})\|w_{k, t}^m - w^*\|^2 + \frac{3}{2}\alpha^{-1}\|w_{k, t}^{\textrm{md}, m} - w^*\|^2 + \frac{3}{2}\gamma^2 \|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 \\
    &- 2\gamma(1+\frac{1}{2}\alpha^{-1}) \langle (1-\alpha^{-1}(1-\beta^{-1}))w_{k, t}^m + \alpha^{-1}(1-\beta^{-1})w_{k, t}^{\textrm{ag}, m} - w^*, \nabla F(w_{k, t}^{\textrm{md}, m})\rangle + \gamma^2\sigma^2
\end{align*}
Next, we compute the upper bound of $\mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}]$.
\begin{align*}
    &\mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}] \\
    &\leq \mathbb{E}[F(w_{k, t}^{\textrm{md}, m}) + \langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t+1}^{\textrm{ag}, m} - w_{k, t}^{\textrm{md}, m} \rangle + \frac{L}{2}\|w_{k, t+1}^{\textrm{ag}, m} - w_{k, t}^{\textrm{md}, m}\|^2 - F^*|\mathcal{F}_{k, t}] \\
    &\leq F(w_{k, t}^{\textrm{md}, m}) -F^* - \eta\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &\leq F(w_{k, t}^{\textrm{md}, m}) -F^* - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \textrm{ }(\because 1-\frac{\eta L}{2} \geq \frac{1}{2} \leftarrow \eta \in [0, \frac{1}{L}]) \\
    &= (1-\frac{1}{2}\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) + \frac{1}{2}\alpha^{-1}(F(w_{k, t}^{\textrm{md}, m}) -F^*) \\
    &+ (1-\frac{1}{2}\alpha^{-1})(F(w_{k, t}^{\textrm{md}, m}) - F(w_{k, t}^{\textrm{ag}, m})) - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &\leq (1-\frac{1}{2}\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) - \frac{\mu\alpha^{-1}}{4}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2 + \frac{1}{2}\alpha^{-1} \langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t}^{\textrm{md}, m}-w^*\rangle \\
    &+ (1-\frac{1}{2}\alpha^{-1})\langle \nabla F(w_{k, t}^{\textrm{md}, m}), w_{k, t}^{\textrm{md}, m} - w_{k, t}^{\textrm{ag}, m}\rangle - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &= (1-\frac{1}{2}\alpha^{-1})(F(w_{k, t}^{\textrm{ag}, m})-F^*) - \frac{\mu\alpha^{-1}}{4}\|w_{k, t}^{\textrm{md}, m}-w^*\|^2 - \frac{\eta}{2}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{\eta^2 L}{2}\sigma^2 \\
    &+ \frac{1}{2}\alpha^{-1} \langle \nabla F(w_{k, t}^{\textrm{md}, m}), 2\alpha\beta^{-1}w_{k, t}^m + (1 - 2\alpha\beta^{-1})w_{k, t}^{\textrm{ag}, m} - w^*\rangle
\end{align*}
It is easy to show $\frac{1}{2}\alpha^{-1} = \frac{\gamma\mu}{3}(1+\frac{1}{2}\alpha^{-1})$. Then, we bound $\mathbb{E}[\Phi_{k, t+1}^m|\mathcal{F}_{k, t}]$ by using the above results.
\begin{align} \label{ineqD.5-4}
    \mathbb{E}[\Phi_{k, t+1}^m|\mathcal{F}_{k, t}] &= \frac{\mu}{6}\mathbb{E}[\|w_{k, t+1}^m-w^*\|^2|\mathcal{F}_{k, t}] + \mathbb{E}[F(w_{k, t+1}^{\textrm{ag}, m}) - F^*|\mathcal{F}_{k, t}] \nonumber\\
    &\leq (1-\frac{1}{2}\alpha^{-1})\Phi_{k, t}^m - \frac{2\eta - \gamma^2\mu}{4}\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2 + \frac{1}{2}(\frac{\gamma^2\mu}{3}+\eta^2 L)\sigma^2 \nonumber\\
    &\leq (1-\frac{1}{2}\alpha^{-1})\Phi_{k, t}^m  + \frac{1}{2}(\frac{\gamma^2\mu}{3}+\eta^2 L)\sigma^2 \textrm{ }(\because \gamma \leq \sqrt{\frac{\eta}{\mu}}) \nonumber\\
    &\leq (1-\frac{1}{2}\alpha^{-1})\Phi_{k, t}^m  + \frac{\gamma^2}{2}(\frac{\mu}{3}+L)\sigma^2
\end{align}
Plugging (\ref{ineqD.5-3}), (\ref{ineqD.5-4}) in (\ref{eqD.5-1}) yields,
\begin{align} \label{ineqD.5-5}
    &\mathbb{E}[B_{k, t+1}^m|\mathcal{F}_{k, t}] \nonumber\\
    &\leq  \Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\Big((1-\alpha^{-1})^2(1+2\alpha^{-1}) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 \nonumber\\
    &+ (\gamma-\eta)^2(1+\frac{\alpha}{2}) \cdot (\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m) + (\gamma-\eta)^2 \sigma^2 \Big) \nonumber\\
    &+ \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L\Big((1-\frac{1}{2}\alpha^{-1})\Phi_{k, t}^m  + \frac{\gamma^2}{2}(\frac{\mu}{3}+L)\sigma^2\Big) \nonumber\\
    &= (1-\alpha^{-1})^2(1+2\alpha^{-1})\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big) \|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2 \nonumber\\
    &+ \bigg(\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)(\gamma-\eta)^2(1+\frac{\alpha}{2}) + (1-\frac{1}{2}\alpha^{-1})\gamma^2(\frac{\mu}{3}+L)\bigg) \nonumber\\
    &\cdot(\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m) + \bigg(\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)(\gamma-\eta)^2+\gamma^4(\frac{\mu}{3}+L)^2\frac{2\alpha^2-\alpha}{2\alpha^2-1}L\bigg)\sigma^2
\end{align}
We can show that both coefficients of $\|w_{k, t}^m - w_{k, t}^{\textrm{md}, m}\|^2$ and $\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \Phi_{k, t}^m$ are upper bounded by $1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}}$.
\begin{align} \label{ineqD.5-6}
    &(1-\alpha^{-1})^2(1+2\alpha^{-1}) \leq 1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}} \textrm{}(<1) \\
    \Leftrightarrow \textrm{} &1-\frac{1}{4}\alpha^{-2}+\frac{1}{2}\alpha^{-1} - (1-\alpha^{-1})^2(1+2\alpha^{-1})(1+\frac{1}{2}\alpha^{-1}) \geq 0 \nonumber
\end{align}
Let's define $g_1(\alpha^{-1}) = 1-\frac{1}{4}\alpha^{-2}+\frac{1}{2}\alpha^{-1} - (1-\alpha^{-1})^2(1+2\alpha^{-1})(1+\frac{1}{2}\alpha^{-1})$. Then, it is easy to check that $g_1(\alpha^{-1}) \geq 0$ for $0 < \alpha^{-1} \leq 1$. Moreover, we would like to show the below inequality.
\begin{align} \label{ineqD.5-7}
    &\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)(\gamma-\eta)^2(1+\frac{\alpha}{2}) + (1-\frac{1}{2}\alpha^{-1})\gamma^2(\frac{\mu}{3}+L) \nonumber \\
    \leq \textrm{ } &\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\gamma^2(1+\frac{\alpha}{2}) + (1-\frac{1}{2}\alpha^{-1})\gamma^2(\frac{\mu}{3}+L) \nonumber\\
    \leq \textrm{ } &(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})\gamma^2(\frac{\mu}{3}+L)
\end{align}
Since $\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2} = \frac{\mu}{3}(\frac{2\alpha-1}{2\alpha^2-1})^2 + L(\frac{\alpha-1}{2\alpha^2-1})^2 \leq (\frac{\mu}{3}+\frac{L}{4})(\frac{2\alpha-1}{2\alpha^2-1})^2$, it is enough to show
\begin{align*}
    (\frac{\mu}{3}+\frac{L}{4})(\frac{2\alpha-1}{2\alpha^2-1})^2\gamma^2 (1+\frac{\alpha}{2}) \leq \frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}} \gamma^2 (\frac{\mu}{3}+L)
\end{align*}
We also know that $\frac{\frac{\mu}{3}+L}{\frac{\mu}{3}+\frac{L}{4}}=4-\frac{1}{\frac{1}{3}+\frac{L}{\mu}\cdot\frac{1}{4}} > \frac{16}{7} \textrm{ }(\because \frac{L}{\mu}>1)$. Then, we only need to show
\begin{align*}
    &(\frac{2\alpha-1}{2\alpha^2-1})^2(1+\frac{\alpha}{2}) \leq \frac{16}{7}\cdot\frac{\frac{1}{2}}{\alpha+\frac{1}{2}} \\
    \Leftrightarrow \textrm{ } &\frac{8}{7}(2\alpha^2 -1)^2 - (2\alpha-1)^2(1+\frac{\alpha}{2})(\alpha+\frac{1}{2}) \geq 0
\end{align*}
Let's define $g_2(\alpha) = \frac{8}{7}(2\alpha^2 -1)^2 - (2\alpha-1)^2(1+\frac{\alpha}{2})(\alpha+\frac{1}{2})$. Then, it is easy to check $g_2(\alpha) \geq 0$ for $\alpha \geq \frac{3}{2}$. As we assume $\gamma\mu \leq \frac{3}{4}$, we can say $\alpha = \frac{3}{2\gamma\mu}-\frac{1}{2} \geq \frac{3}{2}$. This indicates that the inequality (\ref{ineqD.5-7}) is satisfied. Thus, from (\ref{ineqD.5-5}), (\ref{ineqD.5-6}), and (\ref{ineqD.5-7}) we finally get
\begin{align*}
    \mathbb{E}[B_{k, t+1}^m|\mathcal{F}_{k, t}] &\leq (1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})B_{k, t}^m \\
    &+ \bigg(\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)(\gamma-\eta)^2+\gamma^4(\frac{\mu}{3}+L)^2\frac{2\alpha^2-\alpha}{2\alpha^2-1}L\bigg)\sigma^2
\end{align*}
From this relationship between $B_{k, t+1}^m$ and $B_{k, t}^m$, we obtain the result of Proposition \ref{propositionD.5}.
\begin{align*}
    \mathbb{E}[B_{k, t}^m] &\leq (1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\mathbb{E}[B_{k, 0}^m] + \bigg(\Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)(\gamma-\eta)^2 \\
    &+\gamma^4(\frac{\mu}{3}+L)^2\frac{2\alpha^2-\alpha}{2\alpha^2-1}L\bigg)\sigma^2 \cdot \frac{1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t}{1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})} \\
    &\leq \mathbb{E}[B_{k, 0}^m] + \bigg( \Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big)\cdot(\gamma - \eta)^2+ \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \bigg) \\
    &\cdot \frac{1 + \frac{1}{2}\alpha^{-1}}{\frac{1}{4}\alpha^{-2}} \cdot \Big( 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big)\sigma^2
\end{align*}

\begin{proposition} \label{propositionD.6}
Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma \in [\eta, \sqrt{\frac{\eta}{\mu}}], \eta, \gamma \in (0, \frac{1}{L}], \gamma\mu \leq \frac{3}{4},\tau \geq 2,$ FedAQ yields
\begin{align*}
    \frac{\mu}{6}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &\leq \Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2L(\frac{\mu}{3}+L)\Big)\tau^2 \mathbb{E}[\Phi_k] \\
    &+ (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( (\gamma-\eta)^2\gamma^2\mu^2(\frac{\mu}{3}+\frac{L}{4})+\gamma^4(\frac{\mu}{3}+L)^2 L \Big) \frac{\tau^3\sigma^2}{2}
\end{align*}
\end{proposition}

\emph{Proof of Proposition \ref{propositionD.6}} \textrm{ } We use the same upper bounds for $\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2]$ and $\mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2]$ as in Proposition \ref{proposition3.6}.
\begin{align*}
    \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] &\leq \tau \Big(\sum_{t=0}^{\tau-1} 2\alpha^{-2}(1-\beta^{-1})^2\mathbb{E}[\|w_{k, t}^m- w_{k, t}^{\textrm{ag}, m}\|^2 ] + 2\gamma^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big) \\
    &+2\tau\gamma^2\sigma^2 \\
    \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &\leq \tau \Big(\sum_{t=0}^{\tau-1} 2\beta^{-2}\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + 2\eta^2\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big) +2\tau\eta^2\sigma^2
\end{align*}
Thus, by using the above results, we get
\begin{align*}
    &\frac{\mu}{6}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq \tau \sum_{t=0}^{\tau-1} \Big\{ \Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + (\frac{\gamma^2\mu}{3} + \eta^2 L)\mathbb{E}[\|\nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\Big\} \\
    &+ (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \\
    &\leq \tau \sum_{t=0}^{\tau-1} \Big\{ \Big(\frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_{k, t}^m - w_{k, t}^{\textrm{ag}, m}\|^2] + \gamma^2(\frac{\mu}{3}+L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}2L\mathbb{E}[\Phi_{k, t}^m]\Big\} \\
    &+ (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \textrm{ }(\because (\ref{ineqD.5-2})) \\
    &= \tau \Big( \sum_{t=0}^{\tau-1} \mathbb{E}[B_{k, t}^m]\Big) + (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2
\end{align*}
By Proposition \ref{propositionD.5} and the fact $\Phi_{k, 0}^m = \Phi_k$, we obtain
\begin{align*}
    &\frac{\mu}{6}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq \tau \Big\{ \sum_{t=0}^{\tau-1} \mathbb{E}[B_{k, 0}^m] + \bigg( \Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big)(\gamma - \eta)^2 + \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \bigg) \\
    &\frac{1 + \frac{1}{2}\alpha^{-1}}{\frac{1}{4}\alpha^{-2}} \Big( 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big)\sigma^2\Big\} + (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \\
    &= \tau^2 \bigg(\Big( \frac{\mu\alpha^{-2}}{3}(1-\beta^{-1})^2 + L\beta^{-2}\Big)\mathbb{E}[\|w_k-w_k^{\textrm{ag}}\|^2] + \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L\mathbb{E}[\Phi_{k}]\bigg) \\
    &+ \tau \bigg( \Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big) \cdot (\gamma - \eta)^2 + \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \bigg) \frac{1 + \frac{1}{2}\alpha^{-1}}{\frac{1}{4}\alpha^{-2}} \\
    &\cdot \Big(\sum_{t=0}^{\tau-1} 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big)\sigma^2 + (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2
\end{align*}
Before we get to the final result, let's find the upper bound for $\|w_k - w_k^{\textrm{ag}}\|^2$, $\sum_{t=0}^{\tau-1}\Big( 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big)$
\begin{align*}
    \|w_k - w_k^{\textrm{ag}}\|^2 &= \|w_k - w^* -(w_k^{\textrm{ag}}-w^*)\|^2 \nonumber\\
    &\leq (1+\frac{1}{3})\|w_k - w^*\|^2 + (1+3)\|w_k^{
    \textrm{ag}}-w^*\|^2 \nonumber\\
    &\leq \frac{4}{3}\|w_k - w^*\|^2 + 4\cdot \frac{2}{\mu}\Big(F(w_k^{\textrm{ag}})-F^*-\langle\nabla F(w^*),w_k^{\textrm{ag}}-w^*\rangle\Big) \nonumber\\
    &= \frac{4}{3}\|w_k-w^*\|^2 + \frac{8}{\mu}(F(w_k^{\textrm{ag}})-F^*) = \frac{8}{\mu}\Phi_k
\end{align*}
\begin{align*}
    \sum_{t=0}^{\tau-1}\Big( 1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t\Big) &= \tau - \sum_{t=0}^{\tau-1} (1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^t \\
    &= \tau - \frac{1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})^\tau}{1-(1-\frac{1}{2}\alpha^{-1}+\frac{\frac{1}{2}\alpha^{-1}}{1+\frac{1}{2}\alpha^{-1}})} \\
    &\leq \tau - \frac{1-(1-\frac{\frac{1}{4}\alpha^{-2}}{1+\frac{1}{2}\alpha^{-1}}\tau + (\frac{\frac{1}{4}\alpha^{-2}}{1+\frac{1}{2}\alpha^{-1}})^2\frac{\tau(\tau-1)}{2})}{\frac{\frac{1}{4}\alpha^{-2}}{1+\frac{1}{2}\alpha^{-1}}} \\
    &= \frac{\frac{1}{4}\alpha^{-2}}{1+\frac{1}{2}\alpha^{-1}}\cdot\frac{\tau(\tau-1)}{2} \leq \frac{\frac{1}{4}\alpha^{-2}}{1+\frac{1}{2}\alpha^{-1}}\cdot\frac{\tau^2}{2}
\end{align*}
Therefore, we obtain
\begin{align} \label{ineqD.6-1}
    &\frac{\mu}{6}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \nonumber\\
    &\leq \Big(\frac{8}{3}\alpha^{-2}(1-\beta^{-1})^2 +\frac{8L}{\mu}\beta^{-2} + \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L\Big)\tau^2 \mathbb{E}[\Phi_k] + (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2\nonumber\\
    &+ \bigg( \Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big)\cdot (\gamma - \eta)^2 + \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \bigg) \cdot\frac{\tau^3\sigma^2}{2}
\end{align}
Moreover, we can simplify the above inequality by replacing $\alpha, \beta$ with $\gamma, \mu$. It is easy to show $\frac{2\alpha^2-\alpha}{2\alpha^2-1} \leq 1, \frac{2\alpha-1}{2\alpha^2-1} \leq \frac{1}{\alpha} = \frac{2\gamma\mu}{3-\gamma\mu} \leq \gamma\mu$. Then, we can further show
\begin{align} \label{ineqD.6-2}
    &\frac{8}{3}\alpha^{-2}(1-\beta^{-1})^2 +\frac{8L}{\mu}\beta^{-2} + \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \nonumber\\
    = &\frac{8}{3}(\frac{2\alpha-1}{2\alpha^2-1})^2 +\frac{8L}{\mu}(\frac{\alpha-1}{2\alpha^2-1})^2 + \gamma^2(\frac{\mu}{3} + L)\frac{2\alpha^2-\alpha}{2\alpha^2-1}\cdot 2L \nonumber\\
    \leq &(\frac{8}{3} + \frac{2L}{\mu})(\frac{2\alpha-1}{2\alpha^2-1})^2 + \gamma^2(\frac{\mu}{3} + L)2L \nonumber\\
    \leq &(\frac{8}{3} + \frac{2L}{\mu})\alpha^{-2} + \gamma^2(\frac{\mu}{3} + L)2L \nonumber\\
    \leq &\gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2 L(\frac{\mu}{3}+L)
\end{align}
We also get
\begin{align} \label{ineqD.6-3}
    &\Big(\frac{\mu}{3} (\frac{2\alpha-1}{2\alpha^2 -1})^2 + L(\frac{\alpha-1}{2\alpha^2 -1})^2 \Big)\cdot (\gamma - \eta)^2 + \gamma^4 (\frac{\mu}{3} + L)^2 \frac{2\alpha^2 - \alpha}{2\alpha^2 - 1}L \nonumber\\
    \leq &(\frac{\mu}{3}+\frac{L}{4})(\frac{2\alpha-1}{2\alpha^2 -1})^2 (\gamma - \eta)^2 + \gamma^4 (\frac{\mu}{3} + L)^2 L \nonumber\\
    \leq &(\gamma - \eta)^2\gamma^2\mu^2(\frac{\mu}{3}+\frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L
\end{align}
Finally, from (\ref{ineqD.6-1}), (\ref{ineqD.6-2}), and (\ref{ineqD.6-3}), we conclude as below
\begin{align*}
    \frac{\mu}{6}\mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{L}{2} \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] &\leq \Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2L(\frac{\mu}{3}+L)\Big)\tau^2 \mathbb{E}[\Phi_k] \\
    &+ (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( (\gamma-\eta)^2\gamma^2\mu^2(\frac{\mu}{3}+\frac{L}{4})+\gamma^4(\frac{\mu}{3}+L)^2 L \Big) \frac{\tau^3\sigma^2}{2}
\end{align*}

\emph{Proof of Lemma \ref{lemmaD.1}} \textrm{ } By the definition of $\Phi_k, \Phi_{k, t}$ and Proposition \ref{propositionD.2},
\begin{gather*}
    \mathbb{E}[\Phi_{k+1}] = \mathbb{E}[\Phi_{k, \tau}] + \frac{\mu}{6}\mathbb{E}[\|w_{k+1} - \Bar{w}_{k, \tau}\|^2] + \mathbb{E}[F(w_{k+1}^{\textrm{ag}}) - F(\Bar{w}_{k, \tau}^{\textrm{ag}})]
\end{gather*}
Applying Proposition \ref{propositionD.3} and Proposition \ref{propositionD.4}, we have
\begin{align*}
    &\mathbb{E}[\Phi_{k+1}] \\
    &\leq (1-\frac{1}{3}\gamma\mu)^\tau \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \\
    &+ \frac{q\mu}{6M^2}\sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^m - w_k\|^2] + \frac{qL}{2M^2} \sum_{m=1}^M \mathbb{E}[\|w_{k, \tau}^{\textrm{ag}, m} - w_k^{\textrm{ag}}\|^2] \\
    &\leq (1-\frac{1}{3}\gamma\mu)^\tau \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \\
    &+ \frac{q}{M}\Big[ \Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2L(\frac{\mu}{3}+L)\Big)\tau^2 \mathbb{E}[\Phi_k] + (\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \\
    &+ \Big( (\gamma-\eta)^2\gamma^2\mu^2(\frac{\mu}{3}+\frac{L}{4})+\gamma^4(\frac{\mu}{3}+L)^2 L \Big) \frac{\tau^3\sigma^2}{2}\Big] \\
    &= D(\gamma, \tau) \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2]\\
    &+ \frac{q}{M}(\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big( (\gamma-\eta)^2 \gamma^2\mu^2 (\frac{\mu}{3} + \frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L \Big)\tau^3\sigma^2
\end{align*}
The second inequality comes from Proposition \ref{propositionD.6}. $D(\gamma, \tau)$ is defined as below.
\begin{align*}
    D(\gamma, \tau) &= (1-\frac{1}{3}\gamma\mu)^\tau + \frac{q}{M}\Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2 L(\frac{\mu}{3} + L)\Big)\tau^2
\end{align*}

\subsubsection{Proof of Theorem \ref{theorem2}}
\label{app:proof_theorem2}

% \begin{theorem} \label{theorem2}
%     Let F be $\mu$-strongly convex, and assume Assumption \ref{assumption1}, \ref{assumption2}, \ref{assumption3}, \ref{assumption4}, then for $\alpha=\frac{3}{2\gamma\mu} - \frac{1}{2}, \beta=\frac{2\alpha^2-1}{\alpha-1}, \gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}}), \eta, \gamma \in (0, \frac{1}{L}], \gamma\mu \leq \frac{3}{4}, \tau \geq 2, $ if the learning rate $\gamma$ satisfies
%     \begin{align} \label{condition2}
%         \bigg( \frac{1}{9}\mu^2 +\frac{q}{M}\Big( \mu(\frac{8}{3}\mu +2L) + 2L(\frac{\mu}{3}+L)\Big)\bigg)\gamma\tau \leq \frac{1}{6}\mu
%     \end{align}
%     FedAQ yields
%     \begin{align*}
%         \mathbb{E}[\Phi_K] &\leq \exp{\Big(-\frac{1}{6}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Phi_0 + \frac{2(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{8(q+25)\eta^2 L^2\tau\sigma^2}{\mu} \\
%         &+ \frac{3q\Big(\mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2\Big)\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{3qL(\frac{\mu}{3}+L)^2 \eta^3\tau^2\sigma^2}{\mu M}
%     \end{align*}
% \end{theorem}

\emph{Proof of Theorem \ref{theorem2} } At first, due to the condition (\ref{condition2}) in Theorem \ref{theorem2}, we get
\begin{align*}
    D(\gamma, \tau) &= (1-\frac{1}{3}\gamma\mu)^\tau + \frac{q}{M}\Big( \gamma^2\mu(\frac{8}{3}\mu + 2L) + 2\gamma^2 L(\frac{\mu}{3} + L)\Big)\tau^2 \\
    &\leq 1-\frac{1}{3}\gamma\mu\tau + \frac{1}{9}\gamma^2\mu^2\tau^2 + \frac{q}{M}\gamma^2\Big(\mu(\frac{8}{3}\mu+2L)+2L(\frac{\mu}{3}+L)\Big)\tau^2 \\
    &= 1-\frac{1}{3}\gamma\mu\tau + \bigg( \frac{1}{9}\mu^2 +\frac{q}{M}\Big( \mu(\frac{8}{3}\mu +2L) + 2L(\frac{\mu}{3}+L)\Big)\bigg)\gamma^2\tau^2 \\
    &\leq 1 - \frac{1}{6}\gamma\mu\tau \textrm{ }(\because \textrm{ condition } (\ref{condition2}))
\end{align*}
It is trivial that $\gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}}) \in [\eta, \sqrt{\frac{\eta}{\mu}}]$. Thus, we can use Lemma \ref{lemmaD.1}. By using Lemma \ref{lemmaD.1} and the above result, we obtain
\begin{align} \label{ineqD.7-1}
    &\mathbb{E}[\Phi_{k+1}] \nonumber\\
    &\leq (1-\frac{1}{6}\gamma\mu\tau) \mathbb{E}[\Phi_k] + (\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \gamma\tau \cdot \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \nonumber\\
    &+ \frac{q}{M}(\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 + \frac{q}{2M}\Big( (\gamma-\eta)^2 \gamma^2\mu^2 (\frac{\mu}{3} + \frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L \Big)\tau^3\sigma^2
\end{align}
By the Lemma C.14 in \cite{yuan2020federated}, we know that the below quantity is bounded.
\begin{gather*}
    \max_{0\leq t <\tau} \mathbb{E}[\|\nabla F(\Bar{w}_{k, t}^{\textrm{md}}) - \frac{1}{M} \sum_{m=1}^M \nabla F(w_{k, t}^{\textrm{md}, m})\|^2] \leq B^\prime \\
    B^\prime=
    \begin{cases}
    4\eta^2 L^2\tau\sigma^2\Big(1+\frac{\gamma^2\mu}{\eta}\Big)^{2\tau},~\textrm{ if } \gamma \in \Big(\eta, \sqrt{\frac{\eta}{\mu}}\Big]\\
    4\eta^2 L^2\tau\sigma^2,~\textrm{ if } \gamma=\eta
    \end{cases}
\end{gather*}
Telescoping (\ref{ineqD.7-1}) yields
\begin{align*}
    \mathbb{E}[\Phi_{K}] &\leq (1-\frac{1}{6}\gamma\mu\tau)^K\Phi_0 + \Big(\sum_{k^\prime=0}^{K-1}(1-\frac{1}{6}\gamma\mu\tau)^{k^\prime}\Big)\cdot \Big[(\frac{\eta^2 L}{2} + \frac{\gamma^2\mu}{6})\frac{\tau\sigma^2}{M} + \frac{q}{M}(\frac{\gamma^2\mu}{3}+\eta^2 L)\tau\sigma^2 \nonumber\\
     &+ \frac{q}{2M}\Big( (\gamma-\eta)^2 \gamma^2\mu^2 (\frac{\mu}{3} + \frac{L}{4}) + \gamma^4 (\frac{\mu}{3} + L)^2 L \Big)\tau^3\sigma^2 +\gamma\tau B^\prime \Big] \\
     &\leq \exp\Big(-\frac{\gamma\mu\tau K}{6}\Big)\Phi_0 + \frac{3\eta^2 L\sigma^2}{\gamma\mu M} + \frac{\gamma\sigma^2}{M} + \frac{6B^\prime}{\mu} + 2q\Big(\frac{\gamma\sigma^2}{M}+\frac{3\eta^2 L\sigma^2}{\gamma\mu M}\Big) \\
     &+ \frac{3q}{M}\Big( (\gamma-\eta)^2 \gamma\mu (\frac{\mu}{3} + \frac{L}{4}) + \frac{\gamma^3 (\frac{\mu}{3} + L)^2 L}{\mu} \Big)\tau^2\sigma^2
\end{align*}
The last inequality comes from the fact that $\sum_{k^\prime=0}^{K-1}(1-\frac{1}{6}\gamma\mu\tau)^{k^\prime} \leq \frac{6}{\gamma\mu\tau}$. Since we plug in $\gamma = \max(\eta, \sqrt{\frac{\eta}{\mu\tau}})$, we can use Lemma C.15 in \cite{yuan2020federated}. Therefore, we obtain
\begin{align*}
    \mathbb{E}[\Phi_K] &\leq \exp{\Big(-\frac{1}{6}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Phi_0 + \frac{2(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{4(2q+1)\eta^2 L^2\tau\sigma^2}{\mu} \\
    &+ \frac{24e^2\eta^2 L^2\tau\sigma^2}{\mu} + \frac{3q\tau^2\sigma^2}{M}\max\Big(\frac{\eta^{\frac{3}{2}}\mu(\frac{\mu}{3}+\frac{L}{4})}{\mu^{\frac{3}{2}}\tau^{\frac{3}{2}}}+\frac{\eta^{\frac{3}{2}}(\frac{\mu}{3}+L)^2 L}{\mu^{\frac{5}{2}}\tau^{\frac{3}{2}}}, \frac{\eta^3 (\frac{\mu}{3}+L)^2 L}{\mu}\Big)
\end{align*}
The first term stems directly from Lemma C.15 in \cite{yuan2020federated}. Also, the last term comes from the fact that
\begin{align*}
    (\gamma-\eta)^2 \gamma\mu (\frac{\mu}{3} + \frac{L}{4}) + \frac{\gamma^3 (\frac{\mu}{3} + L)^2 L}{\mu} \leq
    \begin{cases}
    \gamma^3\mu(\frac{\mu}{3}+\frac{L}{4}) + \frac{\gamma^3(\frac{\mu}{3}+L)^2 L}{\mu},~\textrm{ if }\gamma \neq \eta\\
    \frac{\eta^3 (\frac{\mu}{3}+L)^2 L}{\mu},~\textrm{ if } \gamma=\eta
    \end{cases}
\end{align*}
Therefore, by simple inequalities such as $\max(a, b) \leq a+b$ and $\min(a, b) \leq a$, we ultimately get
\begin{align} \label{ineq_theorem2}
    \mathbb{E}[\Phi_K] &\leq \exp{\Big(-\frac{1}{6}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})K\tau\Big)} \Phi_0 + \frac{2(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{8(q+25)\eta^2 L^2\tau\sigma^2}{\mu} \nonumber\\
        &+ \frac{3q\Big(\mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2\Big)\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} + \frac{3qL(\frac{\mu}{3}+L)^2 \eta^3\tau^2\sigma^2}{\mu M}
\end{align}

\subsubsection{Proof of Corollary \ref{corollary2}}
\label{app:proof_corollary2}

\begin{corollary} \label{corollary2}
    Let $D_1, D_2,\textrm{ and } \eta_0$ as below. Note that $T = K\tau$.
    \begin{align*}
        D_1 &= \frac{\Big( \mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2) \Big)q}{\mu^{\frac{5}{2}}}, \textrm{ } D_2 = \frac{q(\frac{\mu}{3}+L)^2 L}{\mu} \\
        \eta_0 &= \frac{36\tau}{\mu T^2}\log^2\Big(e+\min(\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}, \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}, \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}) \Big)
    \end{align*}
    Then for $\eta = \min(\frac{1}{L}, \eta_0)$, FedAQ yields
    \begin{align}
        \mathbb{E}[\Phi_K] &\leq \min \Big( \exp(-\frac{\mu T}{6L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{6 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Phi_0 \nonumber\\
        &+ \frac{13(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}\Big) \\
        &+ \frac{10369(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4}\log^4 \Big(e+ \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}\Big) \\
        &+ \frac{649(\mu^{\frac{3}{2}}D_1+216D_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+216 D_2)\tau^2\sigma^2}\Big)
    \end{align}
\end{corollary}

\emph{Proof of Corollary \ref{corollary2}} \textrm{ } Let's decompose the final result (\ref{ineq_theorem2}) of the Theorem \ref{theorem2} into a decreasing term and an increasing term. We denote the decreasing term $\phi_1$ and the increasing term $\phi_2$ as below.
\begin{align*}
    \phi_1(\eta) &= \exp\Big( -\frac{1}{6}\max(\eta\mu, \sqrt{\frac{\eta\mu}{\tau}})T \Big)\Phi_0 \\
    \phi_2(\eta) &= \frac{2(2q+1)\eta^{\frac{1}{2}}\sigma^2}{\mu^{\frac{1}{2}}M\tau^{\frac{1}{2}}} + \frac{8(q+25)\eta^2 L^2\tau\sigma^2}{\mu} + \frac{3q\Big(\mu^2(\frac{\mu}{3}+\frac{L}{4}) + L(\frac{\mu}{3}+L)^2\Big)\eta^{\frac{3}{2}}\tau^{\frac{1}{2}}\sigma^2}{\mu^{\frac{5}{2}}M} \\
    &+ \frac{3qL(\frac{\mu}{3}+L)^2 \eta^3\tau^2\sigma^2}{\mu M}
\end{align*}
Since $\phi_1$ is the decreasing term, we have
\begin{align} \label{ineq_corollary2-1}
    \phi_1(\eta) \leq \phi_1(\frac{1}{L}) + \phi_1(\eta_0)
\end{align}
where
\begin{align*}
    \phi_1(\frac{1}{L}) &= \min \Big( \exp(-\frac{\mu T}{6L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{6 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Phi_0 \\
    \phi_1(\eta_0) &\leq \exp \Big( -\frac{1}{6} \sqrt{\frac{\eta_0 \mu}{\tau}}T\Big) \\
    &= \Big(e+\min(\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}, \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}, \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}) \Big)^{-1} \Phi_0 \\
    &\leq \frac{(2q+1)\sigma^2}{\mu MT} + \frac{(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4} + \frac{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}{\mu^3 M T^3}
\end{align*}
Since $\phi_2$ is the increasing term, we have
\begin{align} \label{ineq_corollary2-2}
    &\phi_2(\eta) \nonumber\\
    &\leq \phi_2(\eta_0) \nonumber\\
    &\leq \frac{12(2q+1)\sigma^2}{\mu MT}\log\Big(e+\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}\Big) + \frac{8\cdot36^2(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4}\log^4 \Big(e+ \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}\Big)\nonumber\\
    &+ \frac{3\cdot6^3 D_1 \tau^2\sigma^2}{\mu^{\frac{3}{2}}MT^3}\log^3\Big(e+\frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}\Big) \nonumber\\
    &+ \frac{3\cdot36^3 D_2\tau^5\sigma^2}{\mu^3 MT^6} \log^6\Big(e+ \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}\Big) \nonumber\\
    &\leq \frac{12(2q+1)\sigma^2}{\mu MT}\log\Big(e+\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}\Big) + \frac{8\cdot36^2(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4}\log^4 \Big(e+ \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}\Big) \nonumber\\
    &+ \frac{3\cdot6^3 (\mu^{\frac{3}{2}}D_1+6^3 D_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+6^3  D_2)\tau^2\sigma^2}\Big)
\end{align}
The last inequality comes from $\frac{\tau}{T} \leq 1$. Therefore, by combining (\ref{ineq_corollary2-1}) and (\ref{ineq_corollary2-2}), we finally get
\begin{align*}
    \mathbb{E}[\Phi_K] &\leq \phi_1(\eta) + \phi_2(\eta) \\
    &\leq \phi_1(\frac{1}{L}) + \phi_1(\eta_0) + \phi_2(\eta_0) \\
    &\leq \min \Big( \exp(-\frac{\mu T}{6L}), \exp(-\frac{\mu^{\frac{1}{2}}T}{6 L^{\frac{1}{2}}\tau^{\frac{1}{2}}})\Big) \Phi_0 + \frac{13(2q+1)\sigma^2}{\mu MT} \log^2 \Big(e+\frac{\mu M T \Phi_0}{(2q+1)\sigma^2}\Big) \\
        &+ \frac{10369(q+25)L^2\tau^3\sigma^2}{\mu^3 T^4}\log^4 \Big(e+ \frac{\mu^3 T^4\Phi_0}{(q+25)L^2\tau^3\sigma^2}\Big) \\
        &+ \frac{649(\mu^{\frac{3}{2}}D_1+216D_2)\tau^2\sigma^2}{\mu^3 M T^3} \log^6 \Big(e + \frac{\mu^3 M T^3\Phi_0}{(\mu^{\frac{3}{2}}D_1+216 D_2)\tau^2\sigma^2}\Big)
\end{align*}

\subsection{More Theoretical Details about Remark \ref{remark5.5} and Contribution \ref{contribution2} in Introduction}%\cite{haddadpour2021federated}
\label{app:fedcomgate}

\subsubsection{Why Haddadpour et al. (2021) Cannot Achieve a Linear Speedup}
It is hard to say that \cite{haddadpour2021federated} achieves a linear speedup in $M$ in strongly-convex and homogeneous settings. Let's first recap Corollary D.8 in \cite{haddadpour2021federated}. They let $\eta\gamma\mu\tau \leq \frac{1}{2}, \kappa = \frac{L}{\mu}, \gamma \geq M$ and tune $\eta$ as $\eta = \frac{1}{2L(\frac{q}{M}+1)\tau\gamma}$. Here, $\eta$ is the client learning rate, and $\gamma$ is the server learning rate. Other parameters are the same as we defined. Then, they obtain the below result.
\begin{align} \label{app:C1-rate1}
    \mathbb{E}[F(w_K)- F^*] &\leq \exp(-\eta\gamma\mu\tau K)(F(w_0) - F^*) + \frac{1}{\mu}\Big[\frac{1}{2}\tau L^2\eta^2\sigma^2 + (1+q)\frac{\gamma\eta L\sigma^2}{2M}\Big] \\
    &\leq \mathcal{O} \Big(\exp(-\frac{K}{2(\frac{q}{M}+1)\kappa})(F(w_0) - F^*) + \frac{\sigma^2}{\gamma^2\mu\tau} + \frac{(q+1)\sigma^2}{\mu(\frac{q}{M}+1)\tau M} \Big) \nonumber \\
    &= \mathcal{O} \Big(\exp(-\frac{K}{2(\frac{q}{M}+1)\kappa})(F(w_0) - F^*) + \frac{\sigma^2 K}{\gamma^2\mu T} + \frac{(q+1)K \sigma^2}{\mu(\frac{q}{M}+1)T M} \Big) \nonumber
\end{align}
Let's focus on the second and third term. We assume $M$ is large enough and represent them only with $\gamma, K, T, M$ to easily check the linear speedup of this convergence rate. Then, we obtain
\begin{align} \label{app:C1-rate2}
    \mathcal{O}\Big( \frac{K}{\gamma^2 T} + \frac{K}{MT}\Big) \leq \mathcal{O}\Big( \frac{K}{M^2 T} + \frac{K}{MT}\Big) \textrm{ }(\because \gamma \geq M)
\end{align}
Thus, it seemingly achieves a linear speedup in $M$ when $K$ is just a constant. However, we are missing the critical point in this analysis. To be specific, let's consider the case when $\gamma = 1$. Then, the convergence rate (\ref{app:C1-rate2}) changes into $\mathcal{O}\Big( \frac{K}{T} + \frac{K}{MT}\Big)$ that cannot achieve a linear speedup in $M$. This is implausible because the convergence rate (\ref{app:C1-rate1}) becomes tighter when $\gamma = 1$ than $\gamma \geq M$ (See the last term of (\ref{app:C1-rate1})). Actually, we can achieve a linear speedup in $M$ when $\gamma = 1$ if we tune $\eta = \frac{1}{2L(\frac{q}{M}+1)\tau M}$. However, this is not an appropriate tuning because there is $M$ in the denominator. Similarly, \cite{haddadpour2021federated} tunes $\eta = \frac{1}{2L(\frac{q}{M}+1)\tau\gamma}$ where $\gamma \geq M$. Even though there is no $M$ in the denominator, the condition $\gamma \geq M$ forcibly makes the convergence rate achieve a linear speedup without any theoretical benefits of the algorithm. Therefore, we cannot say their $\eta$ makes their algorithm achieve a linear speedup in $M$. We should tune in a different way that does not contain $M$ in a denominator. For reference, our tuning parameter $\eta$ for the FedAQ algorithm does not contain $M$ in the denominator (See Corollary \ref{corollary1} and Corollary \ref{corollary2}).

\subsubsection{New Convergence Rate for Haddadpour et al. (2021)}

We propose new $\eta$ and convergence rate for \cite{haddadpour2021federated}. This new $\eta$ makes the algorithm achieve a linear speedup in $M$. Let's denote $\Phi_0 = F(w_0) - F^*$. We also know that $T = K\tau$. Then, we choose $\eta$ as
\begin{align*}
    \eta = \frac{1}{\gamma\mu T}\log \Big( e+ \min (\frac{\gamma^2\mu^3 T^2 \Phi_0}{\tau L^2\sigma^2}, \frac{\mu^2 MT\Phi_0}{(1+q)L\sigma^2})\Big)
\end{align*}
We plug in this $\eta$ to (\ref{app:C1-rate1}). We bound the first term as below.
\begin{align*}
    \exp(-\eta\gamma\mu\tau K)(F(w_0) - F^*) &= \Big( e+ \min (\frac{\gamma^2\mu^3 T^2 \Phi_0}{\tau L^2\sigma^2}, \frac{\mu^2 MT\Phi_0}{(1+q)L\sigma^2})\Big)^{-1} \Phi_0 \\
    &\leq \frac{\tau L^2\sigma^2}{\gamma^2\mu^3 T^2} + \frac{(1+q)L\sigma^2}{\mu^2 MT}
\end{align*}
The another terms are bounded as below.
\begin{align*}
    \frac{1}{\mu}\Big[\frac{1}{2}\tau L^2\eta^2\sigma^2 + (1+q)\frac{\gamma\eta L\sigma^2}{2M}\Big] &\leq \frac{\tau L^2\sigma^2}{2\gamma^2\mu^3 T^2} \log^2 \Big( e+\frac{\gamma^2\mu^3 T^2\Phi_0}{\tau L^2\sigma^2}\Big) \\
    &+ \frac{(1+q)L\sigma^2}{2\mu^2 MT}\log\Big( e+ \frac{\mu^2 MT\Phi_0}{(1+q)L\sigma^2}\Big)
\end{align*}
Thus, we obtain a new convergence rate by combining the above two bounds.
\begin{align*}
    \mathbb{E}[F(w_K)- F^*] &\leq \exp(-\eta\gamma\mu\tau K)(F(w_0) - F^*) + \frac{1}{\mu}\Big[\frac{1}{2}\tau L^2\eta^2\sigma^2 + (1+q)\frac{\gamma\eta L\sigma^2}{2M}\Big] \\
    &\leq \frac{3\tau L^2\sigma^2}{2\gamma^2\mu^3 T^2} \log^2 \Big( e+\frac{\gamma^2\mu^3 T^2\Phi_0}{\tau L^2\sigma^2}\Big) + \frac{3(1+q)L\sigma^2}{2\mu^2 MT}\log\Big( e+ \frac{\mu^2 MT\Phi_0}{(1+q)L\sigma^2}\Big)
\end{align*}
Here, we replace $\tau$ with $\frac{T}{K}$. Then, we represent the above convergence rate with only $T, K, M, q$.
\begin{gather*}
    \Tilde{\mathcal{O}}(\frac{1}{TK} + \frac{1+q}{MT})
\end{gather*}
This is the new convergence rate we propose in Remark \ref{remark5.5}. We also get $K = \Tilde{\mathcal{O}}(\frac{M}{1+q})$ communication rounds make this algorithm achieve a linear speedup in $M$.

\subsubsection{More Details on Contribution \ref{contribution2} in Introduction} \label{app:quantization_noise}

\paragraph{More Details on $d_{\textrm{quant}}$} This paragraph explains why FedAQ needs to send only $d_{\text{quant}} = O(\log \frac{1}{q})$ bits for each value. We use the result of Lemma 3.1 in \cite{alistarh2017qsgd}. They show the below result with a low-precision quantizer (Example 1 in \cref{problem_setup})
\begin{align*}
    \mathbb{E}[\|Q(x, s) - x\|_2^2] \leq \min(\frac{n}{s^2}, \frac{\sqrt{n}}{s}) \|x\|_2^2
\end{align*}
where $n$ is the dimension of $x$, and $s$ is the number of quantization levels. Then, we regard $q$ as
\begin{align} \label{q_equation}
    q = \frac{\sqrt{n}}{s} = \frac{\sqrt{n}}{2^{d_{\textrm{quant}}}}
\end{align}
Thus, we obtain the following conclusion.
\begin{align*}
    d_{\textrm{quant}} = \frac{\frac{1}{2}\log n + \log \frac{1}{q}}{\log 2} = O(\log \frac{1}{q})
\end{align*}

\paragraph{Comparing FedAQ to FedAC}  We compare computation and communication efficiency of FedAC-II and FedAQ under the condition set (\ref{parameter2_FedAQ}) to achieve the same error. Let's recall the convergence rate of FedAC and FedAQ. The convergence rate of FedAC and FedAQ is respectively $\Tilde{\mathcal{O}}(\frac{1}{MT}+\frac{1}{TK^3})$ and $\Tilde{\mathcal{O}}(\frac{1+q}{MT}+\frac{1+q}{TK^3})$. Let's say FedAC requires $T$ iterations and $K = M^{\frac{1}{3}}$ communication rounds to achieve the error $\frac{1}{MT}$. Then, FedAQ requires
\begin{gather*}
    T^\prime = (1+q)T, \textrm{ } K^\prime = M^{\frac{1}{3}}
\end{gather*}
to achieve the same error $\frac{1}{MT}$. This means FedAQ needs $1+q$ times more local steps and the same number of communication rounds to achieve the same error of FedAC. These local steps do no require any communication with the server hence can be performed without any additional communication overhead.

From discussion in the previous section, if we use the simple low-precision quantizer, we need only $d_{\text{quant}} = O(\log \frac{1}{q})$ bits for communicating values with enough precision that can lead to an error rate of $O(\frac{1}{MT})$. In comparison, FedAC would require $O(\log (MT))$ bits to maintain enough precision to achieve the same error rate. In a majority of tasks in the real world, 32 bits are usually enough for $d_{\textrm{full}}$ to achieve enough precision as we usually don't need converge to a very small error rate. Nonetheless, even if we compare FedAQ(8bits) with to FedAC(32bits), we argue that the overall benefit from less communication by quantization is more influential than the slowdown effect from quantization.

For example, if we consider a $l_2$-regularized logistic regression model for MNIST (strongly convex experiment) and quantize from 32 bits to $d_{\text{quant}} = 8$ bits. Here, $n = 784 \times 10$. We get the following results by using (\ref{q_equation}).
\begin{align*} %\label{app:eqC.3}
    1+q = 1+ \frac{\sqrt{n}}{2^{d_{\textrm{quant}}}} = 1+\frac{\sqrt{7840}}{2^8} \simeq 1.346, \textrm{}
\end{align*}
On the other hand, the ratio of data communicated by FedAC and FedAQ is

\begin{equation*}
    \frac{32}{d_{\textrm{quant}}} = 4
\end{equation*}

In contribution \ref{contribution2}, we claim $1+q \ll \frac{d_{\text{full}}}{d_{\text{quant}}}$ because $d_{\textrm{full}}$ is unbounded as $T$ goes to infinity. In the real world example, $\frac{d_{\text{full}}}{d_{\text{quant}}}=4$ is still much greater than $1+q$. Furthermore, since the local computation is much cheaper than data communication, we conclude that the benefit from less communication by quantization (4 times less bits) overwhelm the slowdown effect from quantization (($1+q$) times more local computation). 